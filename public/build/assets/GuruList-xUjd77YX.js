import{c as C,a as j,L as H,d as q}from"./app-F21Gw_vX.js";import{z as K,i as g,k as u,l as e,e as m,m as M,u as v,r as f,w as W,f as Y,g as J,j as B,U as T,t as x,B as D,O as V,T as X,P as Z,c as _,F,C as U,A as ee,o as te}from"./vendor-0BLfaBTW.js";import{ab as ae,g as re,ac as R,h as se,y as oe,S as ne,ad as le}from"./ui-BH4Jb6j-.js";import{I as ie}from"./ImageCropperModal-eOgvD4aF.js";const de=K("adminGuru",{state:()=>({items:[],currentGuru:null,currentPage:1,perPage:10,total:0,lastPage:1,from:0,to:0,searchQuery:"",loading:!1,error:null}),getters:{hasNextPage:t=>t.currentPage<t.lastPage,hasPrevPage:t=>t.currentPage>1},actions:{async fetchGuru(t=1){var r,o;this.loading=!0,this.error=null,this.currentPage=t;try{const a=await C.get("/yasmin-panel/guru",{params:{page:t,per_page:this.perPage,search:this.searchQuery||void 0}});a.data.success&&(this.items=a.data.data||[],a.data.meta&&(this.currentPage=a.data.meta.current_page,this.lastPage=a.data.meta.last_page,this.total=a.data.meta.total,this.perPage=a.data.meta.per_page,this.from=a.data.meta.from,this.to=a.data.meta.to))}catch(a){this.error=((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.message)||"Gagal memuat data guru"}finally{this.loading=!1}},async fetchGuruById(t){var r,o;this.loading=!0,this.error=null;try{const a=await C.get(`/yasmin-panel/guru/${t}`);if(a.data.success)return this.currentGuru=a.data.data,a.data.data}catch(a){throw this.error=((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.message)||"Gagal memuat detail guru",a}finally{this.loading=!1}},async createGuru(t){var r,o;this.loading=!0,this.error=null;try{const a=await C.post("/yasmin-panel/guru",t,{headers:{"Content-Type":"multipart/form-data"}});if(a.data.success)return a.data.data}catch(a){throw this.error=((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.message)||"Gagal menambahkan guru",a}finally{this.loading=!1}},async updateGuru(t,r){var o,a;this.loading=!0,this.error=null;try{const i=await C.post(`/yasmin-panel/guru/${t}`,r,{headers:{"Content-Type":"multipart/form-data"}});if(i.data.success)return i.data.data}catch(i){throw this.error=((a=(o=i.response)==null?void 0:o.data)==null?void 0:a.message)||"Gagal mengupdate guru",i}finally{this.loading=!1}},async deleteGuru(t){var r,o;this.loading=!0,this.error=null;try{if((await C.delete(`/yasmin-panel/guru/${t}`)).data.success)return await this.fetchGuru(),this.items.length===0&&this.currentPage>1&&await this.goToPage(this.currentPage-1),!0}catch(a){throw this.error=((o=(r=a.response)==null?void 0:r.data)==null?void 0:o.message)||"Gagal menghapus guru",a}finally{this.loading=!1}},setSearch(t){this.searchQuery=t,this.fetchGuru(1)},goToPage(t){t>=1&&t<=this.lastPage&&this.fetchGuru(t)},clearCurrentGuru(){this.currentGuru=null},resetFilters(){this.searchQuery="",this.fetchGuru(1)}}}),ue={class:"flex items-center justify-between"},ge={__name:"GuruListHeader",emits:["add"],setup(t){return(r,o)=>(u(),g("div",ue,[o[2]||(o[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},"Data Guru"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Kelola data guru dan pengajar")],-1)),e("button",{onClick:o[0]||(o[0]=a=>r.$emit("add")),class:"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl font-poppins"},[m(v(ae),{class:"w-5 h-5"}),o[1]||(o[1]=M(" Tambah Guru ",-1))])]))}},pe=j(ge,[["__scopeId","data-v-bd4c9491"]]),ce={class:"text-xl font-bold text-gray-900 dark:text-white font-poppins mb-4"},me={key:0,class:"mb-3"},he={class:"relative group w-32 h-32 mx-auto"},ye=["src"],be={class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center gap-2"},fe={key:0,class:"absolute -top-2 -right-2 px-2 py-1 bg-green-500 text-white text-[10px] rounded-full font-medium flex items-center gap-1"},xe={class:"flex items-center gap-3 pt-4"},ve=["disabled"],ke={__name:"GuruListModal",props:{show:Boolean,editMode:Boolean,form:Object,photoPreview:String,submitting:Boolean},emits:["close","submit","photo-crop","remove-photo"],setup(t,{emit:r}){const o=t,a=r,i=f(null),p=f(!1),n=f(""),d=f(""),y=()=>{var l;(l=i.value)==null||l.click()},w=l=>{var S;const s=(S=l.target.files)==null?void 0:S[0];if(!s)return;if(!s.type.startsWith("image/")){alert("Pilih file gambar yang valid!");return}if(s.size>2*1024*1024){alert("Ukuran file maksimal 2MB!");return}const b=new FileReader;b.onload=L=>{n.value=L.target.result,p.value=!0},b.readAsDataURL(s),l.target.value=""},$=l=>{d.value=URL.createObjectURL(l),a("photo-crop",l)},P=l=>{n.value=l},G=()=>{d.value="",n.value="",a("remove-photo")};return W(()=>o.show,l=>{l||(d.value="",n.value="")}),(l,s)=>(u(),Y(Z,{to:"body"},[m(X,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","leave-active-class":"transition-opacity duration-200","leave-to-class":"opacity-0"},{default:J(()=>[t.show?(u(),g("div",{key:0,onClick:s[5]||(s[5]=b=>l.$emit("close")),class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4"},[e("div",{onClick:s[4]||(s[4]=T(()=>{},["stop"])),class:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md border border-gray-200 dark:border-gray-700 shadow-2xl"},[e("h2",ce,x(t.editMode?"Edit Guru":"Tambah Guru"),1),e("form",{onSubmit:s[3]||(s[3]=T(b=>l.$emit("submit"),["prevent"])),class:"space-y-4"},[e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Foto Guru",-1)),d.value||t.photoPreview?(u(),g("div",me,[e("div",he,[e("img",{src:d.value||t.photoPreview,class:"w-full h-full object-cover rounded-xl border-2 border-gray-200 dark:border-gray-600"},null,8,ye),e("div",be,[e("button",{type:"button",onClick:y,class:"p-2 bg-white/90 text-gray-900 rounded-lg hover:bg-white transition-colors",title:"Ganti"},[m(v(re),{class:"w-4 h-4"})]),e("button",{type:"button",onClick:G,class:"p-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",title:"Hapus"},[m(v(R),{class:"w-4 h-4"})])]),d.value?(u(),g("div",fe,[m(v(se),{class:"w-3 h-3"}),s[7]||(s[7]=M(" 1:1 ",-1))])):B("",!0)])])):(u(),g("div",{key:1,class:"w-32 h-32 mx-auto border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 dark:hover:border-blue-400 transition-colors",onClick:y},[m(v(oe),{class:"w-10 h-10 text-gray-400 mb-2"}),s[8]||(s[8]=e("span",{class:"text-xs text-gray-500 dark:text-gray-400"},"Klik untuk upload",-1))])),s[10]||(s[10]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2 text-center"},"Max 2MB. Akan di-crop ke rasio 1:1.",-1)),e("input",{ref_key:"photoInput",ref:i,type:"file",accept:"image/*",class:"hidden",onChange:w},null,544)]),e("div",null,[s[11]||(s[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[M(" Nama Guru "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":s[0]||(s[0]=b=>t.form.nama=b),type:"text",required:"",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins",placeholder:"Contoh: Budi Santoso, S.Pd"},null,512),[[V,t.form.nama]])]),e("div",null,[s[12]||(s[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},[M(" Mata Pelajaran "),e("span",{class:"text-red-500"},"*")],-1)),D(e("input",{"onUpdate:modelValue":s[1]||(s[1]=b=>t.form.pelajaran=b),type:"text",required:"",class:"w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins",placeholder:"Contoh: Matematika, Fisika"},null,512),[[V,t.form.pelajaran]])]),e("div",xe,[e("button",{type:"button",onClick:s[2]||(s[2]=b=>l.$emit("close")),class:"flex-1 px-4 py-2.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 font-poppins font-medium"}," Batal "),e("button",{type:"submit",disabled:t.submitting,class:"flex-1 px-4 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 text-white rounded-xl font-medium font-poppins"},x(t.submitting?"Menyimpan...":"Simpan"),9,ve)])],32)])])):B("",!0)]),_:1}),m(ie,{show:p.value,"image-src":n.value,"aspect-ratio":1,onClose:s[6]||(s[6]=b=>p.value=!1),onCrop:$,onChangeImage:P},null,8,["show","image-src"])]))}},we=j(ke,[["__scopeId","data-v-91177e2e"]]),Ge={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700"},Pe={class:"flex flex-col md:flex-row gap-4"},$e={class:"flex-1 relative"},Ce=["value"],_e={__name:"GuruListSearch",props:{modelValue:String},emits:["update:modelValue"],setup(t){return(r,o)=>(u(),g("div",Ge,[e("div",Pe,[e("div",$e,[m(v(ne),{class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),e("input",{value:t.modelValue,onInput:o[0]||(o[0]=a=>r.$emit("update:modelValue",a.target.value)),type:"text",placeholder:"Cari nama guru atau mata pelajaran...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,40,Ce)])])]))}},je=j(_e,[["__scopeId","data-v-cb40bd32"]]),Se={key:0,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 py-12"},Me={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4"},Le={class:"text-sm text-red-600 dark:text-red-400 font-poppins"},Be={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Ie={key:0,class:"p-12 text-center"},Te={key:1,class:"overflow-x-auto"},De={class:"w-full"},Ve={class:"divide-y divide-gray-200 dark:divide-gray-700"},Fe={class:"px-6 py-4 text-sm text-gray-900 dark:text-white font-poppins"},Ue={class:"px-6 py-4"},Re=["src","alt"],Ne={class:"px-6 py-4"},Ae={class:"font-semibold text-gray-900 dark:text-white font-poppins"},Ee={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 font-poppins"},Qe={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 font-poppins"},ze={class:"px-6 py-4"},Oe={class:"flex items-center justify-center gap-2"},He=["onClick"],qe=["onClick"],Ke={key:2,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between"},We={class:"text-sm text-gray-600 dark:text-gray-400 font-poppins"},Ye={class:"flex items-center gap-2"},Je=["disabled"],Xe=["onClick"],Ze=["disabled"],et={__name:"GuruListTable",props:{items:Array,loading:Boolean,error:String,pagination:Object},emits:["edit","delete","page-change"],setup(t){const r=t,o=_(()=>{const i=[],p=r.pagination.current_page,n=r.pagination.last_page;let d=Math.max(1,p-2),y=Math.min(n,d+4);y-d<4&&(d=Math.max(1,y-4));for(let w=d;w<=y;w++)i.push(w);return i}),a=i=>i?new Date(i).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-";return(i,p)=>t.loading?(u(),g("div",Se,[m(H,{size:"md",color:"blue"})])):t.error?(u(),g("div",Me,[e("p",Le,x(t.error),1)])):(u(),g("div",Be,[t.items.length===0?(u(),g("div",Ie,[...p[2]||(p[2]=[e("p",{class:"text-gray-600 dark:text-gray-400 font-poppins"},"Belum ada data guru",-1)])])):(u(),g("div",Te,[e("table",De,[p[3]||(p[3]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"#"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Foto"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Nama"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Mata Pelajaran"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Tanggal Dibuat"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Action")])],-1)),e("tbody",Ve,[(u(!0),g(F,null,U(t.items,(n,d)=>(u(),g("tr",{key:n.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"},[e("td",Fe,x((t.pagination.current_page-1)*t.pagination.per_page+d+1),1),e("td",Ue,[e("img",{src:n.foto||"/images/placeholder-avatar.jpg",alt:n.nama,class:"w-12 h-12 rounded-lg object-cover"},null,8,Re)]),e("td",Ne,[e("p",Ae,x(n.nama),1)]),e("td",Ee,x(n.pelajaran),1),e("td",Qe,x(a(n.created_at)),1),e("td",ze,[e("div",Oe,[e("button",{onClick:y=>i.$emit("edit",n),class:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 hover:bg-blue-100 dark:hover:bg-blue-900/30",title:"Edit"},[m(v(le),{class:"w-4 h-4"})],8,He),e("button",{onClick:y=>i.$emit("delete",n.id),class:"p-2 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30",title:"Hapus"},[m(v(R),{class:"w-4 h-4"})],8,qe)])])]))),128))])])])),t.items.length>0?(u(),g("div",Ke,[e("p",We," Showing "+x(t.pagination.from||0)+" to "+x(t.pagination.to||0)+" of "+x(t.pagination.total||0)+" entries ",1),e("div",Ye,[e("button",{onClick:p[0]||(p[0]=n=>i.$emit("page-change",t.pagination.current_page-1)),disabled:t.pagination.current_page===1,class:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 font-poppins disabled:opacity-50 disabled:cursor-not-allowed"},"Previous",8,Je),(u(!0),g(F,null,U(o.value,n=>(u(),g("button",{key:n,onClick:d=>i.$emit("page-change",n),class:ee(["px-4 py-2 rounded-lg font-semibold font-poppins",n===t.pagination.current_page?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200"])},x(n),11,Xe))),128)),e("button",{onClick:p[1]||(p[1]=n=>i.$emit("page-change",t.pagination.current_page+1)),disabled:t.pagination.current_page===t.pagination.last_page,class:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 font-poppins disabled:opacity-50 disabled:cursor-not-allowed"},"Next",8,Ze)])])):B("",!0)]))}},tt=j(et,[["__scopeId","data-v-245352fd"]]),at={class:"space-y-6"},rt={__name:"GuruList",setup(t){const r=de(),{showSuccess:o,showError:a,showWarning:i,confirmDelete:p}=q(),n=f(!1),d=f(!1),y=f(null),w=f(!1),$=f(null),P=f(null),G=f(null),l=f({nama:"",pelajaran:""}),s=_(()=>r.loading),b=_(()=>r.error),S=_(()=>r.items),L=_(()=>({current_page:r.currentPage,last_page:r.lastPage,per_page:r.perPage,total:r.total,from:r.from,to:r.to})),N=c=>r.goToPage(c),A=c=>{G.value=c,$.value=URL.createObjectURL(c)},E=()=>{$.value=null,P.value=null,G.value=null},Q=c=>{d.value=!0,y.value=c.id,l.value.nama=c.nama,l.value.pelajaran=c.pelajaran,$.value=c.foto,P.value=null,G.value=null,n.value=!0},z=async()=>{var c,k;if(!d.value&&!G.value&&!P.value){await i("Foto Diperlukan","Silakan upload foto guru");return}w.value=!0;try{const h=new FormData;h.append("nama",l.value.nama),h.append("pelajaran",l.value.pelajaran),G.value?h.append("foto",G.value,"cropped-photo.webp"):P.value&&h.append("foto",P.value),d.value?(await r.updateGuru(y.value,h),await o("Berhasil!","Data guru berhasil diupdate")):(await r.createGuru(h),await o("Berhasil!","Guru berhasil ditambahkan")),I(),r.fetchGuru()}catch(h){await a("Gagal!",((k=(c=h.response)==null?void 0:c.data)==null?void 0:k.message)||"Terjadi kesalahan")}finally{w.value=!1}},O=async c=>{if((await p("Yakin ingin menghapus?","Data guru yang dihapus tidak bisa dikembalikan.")).isConfirmed)try{await r.deleteGuru(c),await o("Berhasil!","Guru telah dihapus.")}catch{await a("Gagal!","Terjadi kesalahan saat menghapus guru.")}},I=()=>{n.value=!1,d.value=!1,y.value=null,l.value.nama="",l.value.pelajaran="",$.value=null,P.value=null,G.value=null};return te(()=>{r.fetchGuru()}),(c,k)=>(u(),g("div",at,[m(pe,{onAdd:k[0]||(k[0]=h=>n.value=!0)}),m(je,{modelValue:v(r).searchQuery,"onUpdate:modelValue":[k[1]||(k[1]=h=>v(r).searchQuery=h),k[2]||(k[2]=h=>v(r).setSearch(h))]},null,8,["modelValue"]),m(tt,{items:S.value,loading:s.value,error:b.value,pagination:L.value,onEdit:Q,onDelete:O,onPageChange:N},null,8,["items","loading","error","pagination"]),m(we,{show:n.value,"edit-mode":d.value,form:l.value,"photo-preview":$.value,submitting:w.value,onClose:I,onSubmit:z,onPhotoCrop:A,onRemovePhoto:E},null,8,["show","edit-mode","form","photo-preview","submitting"])]))}},it=j(rt,[["__scopeId","data-v-e08a2467"]]);export{it as default};
