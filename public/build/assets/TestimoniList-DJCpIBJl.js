import{a as B,L as Q,c as h,d as _}from"./app-F21Gw_vX.js";import{r as b,w as Y,i as f,k as g,l as e,j as L,t as c,B as C,W as Z,e as m,m as P,u as v,f as ee,g as te,U as G,O as U,X as ae,T as oe,P as se,F as re,C as ne,A as ie,c as I,o as le}from"./vendor-0BLfaBTW.js";import{ab as N,X as de,as as ue,ad as pe,ac as ge,a5 as me}from"./ui-BH4Jb6j-.js";const be={class:"flex flex-col md:flex-row md:items-center justify-between gap-4"},fe={class:"flex items-center gap-3"},ce={key:0,class:"px-3 py-1 bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 text-sm font-bold rounded-full"},xe={class:"flex items-center gap-3"},ve={__name:"TestimoniListHeader",props:{pendingCount:{type:Number,default:0},statusFilter:{type:String,default:"all"}},emits:["add","update:statusFilter"],setup(n,{emit:u}){const a=n,t=b(a.statusFilter);return Y(()=>a.statusFilter,s=>{t.value=s}),(s,l)=>(g(),f("div",be,[e("div",null,[e("div",fe,[l[3]||(l[3]=e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},"Testimoni",-1)),n.pendingCount>0?(g(),f("span",ce,c(n.pendingCount)+" Pending ",1)):L("",!0)]),l[4]||(l[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Kelola testimoni yang tampil di homepage",-1))]),e("div",xe,[C(e("select",{"onUpdate:modelValue":l[0]||(l[0]=x=>t.value=x),onChange:l[1]||(l[1]=x=>s.$emit("update:statusFilter",t.value)),class:"px-4 py-2.5 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white font-poppins focus:ring-2 focus:ring-blue-500"},[...l[5]||(l[5]=[e("option",{value:"all"},"Semua Testimoni",-1),e("option",{value:"active"},"Aktif",-1),e("option",{value:"pending"},"Pending Review",-1)])],544),[[Z,t.value]]),e("button",{onClick:l[2]||(l[2]=x=>s.$emit("add")),class:"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-medium shadow-lg font-poppins"},[m(v(N),{class:"w-5 h-5"}),l[6]||(l[6]=P(" Tambah Testimoni ",-1))])])]))}},ye=B(ve,[["__scopeId","data-v-17f6758a"]]),he={class:"bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full border border-gray-200 dark:border-gray-700 shadow-2xl"},ke={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},we={class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},$e={key:0,class:"mb-3"},Te=["src"],Ce={class:"flex items-center gap-3 pt-2"},Pe={class:"flex items-center gap-3 pt-4"},Se=["disabled"],De={__name:"TestimoniListModal",props:{show:Boolean,editMode:Boolean,form:Object,photoPreview:String,submitting:Boolean},emits:["close","submit","photo-change","remove-photo"],setup(n){const u=a=>a?a.startsWith("http")?a:`/storage/testimonials/${a}`:null;return(a,t)=>(g(),ee(se,{to:"body"},[m(oe,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","leave-active-class":"transition-opacity duration-200","leave-to-class":"opacity-0"},{default:te(()=>[n.show?(g(),f("div",{key:0,class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",onClick:t[9]||(t[9]=G(s=>a.$emit("close"),["self"]))},[e("div",he,[e("div",ke,[e("h2",we,c(n.editMode?"Edit Testimoni":"Tambah Testimoni Baru"),1),e("button",{onClick:t[0]||(t[0]=s=>a.$emit("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[m(v(de),{class:"w-5 h-5 text-gray-500"})])]),e("form",{onSubmit:t[8]||(t[8]=G(s=>a.$emit("submit"),["prevent"])),class:"p-6 space-y-4"},[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[P("Nama "),e("span",{class:"text-red-500"},"*")],-1)),C(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>n.form.author=s),type:"text",required:"",placeholder:"Contoh: Rina Amelia",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[U,n.form.author]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[P("Role/Status "),e("span",{class:"text-red-500"},"*")],-1)),C(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>n.form.role=s),type:"text",required:"",placeholder:"Contoh: Alumni Angkatan 2024",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[U,n.form.role]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[P("Testimoni "),e("span",{class:"text-red-500"},"*")],-1)),C(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=s=>n.form.text=s),rows:"4",required:"",placeholder:"Tulis testimoni di sini...",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins resize-none"},null,512),[[U,n.form.text]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Foto (Opsional)",-1)),n.photoPreview||n.editMode&&n.form.photo?(g(),f("div",$e,[e("img",{src:n.photoPreview||u(n.form.photo),alt:"Preview",class:"w-24 h-24 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700"},null,8,Te),e("button",{type:"button",onClick:t[4]||(t[4]=s=>a.$emit("remove-photo")),class:"mt-2 text-sm text-red-600 dark:text-red-400 hover:underline font-poppins"},"Hapus Foto")])):L("",!0),e("input",{ref:"photoInput",type:"file",accept:"image/*",onChange:t[5]||(t[5]=s=>a.$emit("photo-change",s)),class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl font-poppins file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 file:font-semibold"},null,544),t[14]||(t[14]=e("p",{class:"mt-1 text-xs text-gray-500 font-poppins"},"Jika tidak diisi, akan menggunakan avatar otomatis dari nama",-1))]),e("div",Ce,[C(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>n.form.is_active=s),type:"checkbox",id:"is_active",class:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"},null,512),[[ae,n.form.is_active]]),t[15]||(t[15]=e("label",{for:"is_active",class:"text-sm font-medium text-gray-900 dark:text-white font-poppins"},"Tampilkan di website",-1))]),e("div",Pe,[e("button",{type:"button",onClick:t[7]||(t[7]=s=>a.$emit("close")),class:"flex-1 px-4 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-xl font-semibold font-poppins"},"Batal"),e("button",{type:"submit",disabled:n.submitting,class:"flex-1 px-4 py-3 bg-gradient-to-r from-blue-600 to-purple-600 disabled:from-gray-400 disabled:to-gray-400 text-white rounded-xl font-semibold font-poppins"},c(n.submitting?"Menyimpan...":n.editMode?"Update":"Simpan"),9,Se)])],32)])])):L("",!0)]),_:1})]))}},Fe=B(De,[["__scopeId","data-v-8a7c0ef4"]]),Be={key:0,class:"py-20"},Me={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center"},Ae={class:"text-red-600 dark:text-red-400 font-poppins"},Ue={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Le={class:"overflow-x-auto"},Ge={class:"w-full"},Ve={class:"divide-y divide-gray-200 dark:divide-gray-700"},je=["onDragstart","onDrop"],Ie={class:"px-6 py-4"},Ne={class:"px-6 py-4"},Re={class:"font-semibold text-gray-900 dark:text-white font-poppins"},Ee={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 font-poppins"},He={class:"px-6 py-4"},qe={class:"text-sm text-gray-900 dark:text-white font-poppins line-clamp-2 max-w-md"},ze={class:"px-6 py-4 text-center"},Oe=["onClick"],We={class:"px-6 py-4"},Xe={class:"flex items-center justify-center gap-2"},Je=["onClick"],Ke=["onClick"],Qe={key:3,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 p-12 text-center"},_e={__name:"TestimoniListTable",props:{items:Array,loading:Boolean,error:String},emits:["add","edit","delete","toggle","drag-start","drop"],setup(n){return(u,a)=>n.loading?(g(),f("div",Be,[m(Q,{size:"lg",color:"blue"})])):n.error?(g(),f("div",Me,[e("p",Ae,c(n.error),1)])):n.items.length>0?(g(),f("div",Ue,[a[3]||(a[3]=e("div",{class:"p-4 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-800"},[e("p",{class:"text-sm text-blue-700 dark:text-blue-300 font-poppins"},"Drag & drop untuk mengubah urutan testimoni")],-1)),e("div",Le,[e("table",Ge,[a[2]||(a[2]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins w-10"}),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Nama"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Role"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Testimoni"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Status"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Action")])],-1)),e("tbody",Ve,[(g(!0),f(re,null,ne(n.items,(t,s)=>(g(),f("tr",{key:t.id,draggable:"true",onDragstart:l=>u.$emit("drag-start",s),onDragover:a[0]||(a[0]=G(()=>{},["prevent"])),onDrop:l=>u.$emit("drop",s),class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors cursor-move"},[e("td",Ie,[m(v(ue),{class:"w-4 h-4 text-gray-400"})]),e("td",Ne,[e("p",Re,c(t.author),1)]),e("td",Ee,c(t.role),1),e("td",He,[e("p",qe,'"'+c(t.text)+'"',1)]),e("td",ze,[e("button",{onClick:l=>u.$emit("toggle",t),class:ie(["px-3 py-1.5 rounded-lg text-xs font-semibold",t.is_active?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 hover:bg-green-200":"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400 hover:bg-orange-200"])},c(t.is_active?"Aktif":"Pending"),11,Oe)]),e("td",We,[e("div",Xe,[e("button",{onClick:l=>u.$emit("edit",t),class:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 hover:bg-blue-100",title:"Edit"},[m(v(pe),{class:"w-4 h-4"})],8,Je),e("button",{onClick:l=>u.$emit("delete",t.id),class:"p-2 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100",title:"Hapus"},[m(v(ge),{class:"w-4 h-4"})],8,Ke)])])],40,je))),128))])])])])):(g(),f("div",Qe,[m(v(me),{class:"w-16 h-16 mx-auto mb-4 text-gray-400"}),a[5]||(a[5]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Belum Ada Testimoni",-1)),a[6]||(a[6]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-6 font-poppins"},"Tambahkan testimoni pertama",-1)),e("button",{onClick:a[1]||(a[1]=t=>u.$emit("add")),class:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl font-semibold font-poppins"},[m(v(N),{class:"w-5 h-5"}),a[4]||(a[4]=P(" Tambah Testimoni ",-1))])]))}},Ye=B(_e,[["__scopeId","data-v-06f9e853"]]),Ze={class:"space-y-6"},et={__name:"TestimoniList",setup(n){const{showSuccess:u,showError:a,confirmDelete:t}=_(),s=b([]),l=b(!1),x=b(null),k=b(!1),y=b(!1),M=b(!1),w=b(null),$=b(null),S=b("all"),d=b({author:"",role:"",text:"",photo:null,is_active:!0}),R=I(()=>S.value==="active"?s.value.filter(r=>r.is_active):S.value==="pending"?s.value.filter(r=>!r.is_active):s.value),E=I(()=>s.value.filter(r=>!r.is_active).length);le(()=>{D()});const D=async()=>{var r,i;l.value=!0,x.value=null;try{const o=await h.get("/yasmin-panel/testimonials");o.data.success&&(s.value=o.data.data)}catch(o){x.value=((i=(r=o.response)==null?void 0:r.data)==null?void 0:i.message)||"Gagal memuat data testimoni"}finally{l.value=!1}},H=r=>{const i=r.target.files[0];if(i){d.value.photoFile=i;const o=new FileReader;o.onload=p=>{w.value=p.target.result},o.readAsDataURL(i)}},q=()=>{d.value.photo=null,d.value.photoFile=null,d.value.remove_photo=!0,w.value=null},z=r=>{y.value=!0,d.value={id:r.id,author:r.author,role:r.role,text:r.text,photo:r.photo,is_active:r.is_active,remove_photo:!1},w.value=null,k.value=!0},V=()=>{k.value=!1,y.value=!1,d.value={author:"",role:"",text:"",photo:null,is_active:!0},w.value=null},O=async()=>{var r,i;M.value=!0;try{const o=new FormData;o.append("author",d.value.author),o.append("role",d.value.role),o.append("text",d.value.text),o.append("is_active",d.value.is_active?"1":"0"),d.value.photoFile&&o.append("photo",d.value.photoFile),y.value&&d.value.remove_photo&&o.append("remove_photo","1");let p;y.value?p=await h.post(`/yasmin-panel/testimonials/${d.value.id}`,o,{headers:{"Content-Type":"multipart/form-data"},params:{_method:"PUT"}}):p=await h.post("/yasmin-panel/testimonials",o,{headers:{"Content-Type":"multipart/form-data"}}),p.data.success&&(await u("Berhasil!",y.value?"Testimoni berhasil diupdate!":"Testimoni berhasil ditambahkan!"),V(),D())}catch(o){await a("Gagal!",((i=(r=o.response)==null?void 0:r.data)==null?void 0:i.message)||"Gagal menyimpan testimoni")}finally{M.value=!1}},W=async r=>{var i,o;try{(await h.put(`/yasmin-panel/testimonials/${r.id}/toggle`)).data.success&&(r.is_active=!r.is_active,await u("Berhasil!","Status testimoni berhasil diubah!"))}catch(p){await a("Gagal!",((o=(i=p.response)==null?void 0:i.data)==null?void 0:o.message)||"Gagal mengubah status")}},X=async r=>{var o,p;if((await t("Hapus Testimoni?","Testimoni yang dihapus tidak dapat dikembalikan")).isConfirmed)try{(await h.delete(`/yasmin-panel/testimonials/${r}`)).data.success&&(await u("Berhasil!","Testimoni berhasil dihapus!"),D())}catch(T){await a("Gagal!",((p=(o=T.response)==null?void 0:o.data)==null?void 0:p.message)||"Gagal menghapus testimoni")}},J=async r=>{var T,j;if($.value===null||$.value===r)return;const i=[...s.value],[o]=i.splice($.value,1);i.splice(r,0,o);const p=i.map((F,A)=>({id:F.id,order:A}));try{(await h.post("/yasmin-panel/testimonials/reorder",{items:p})).data.success&&(s.value=i.map((A,K)=>({...A,order:K})),await u("Berhasil!","Urutan testimoni berhasil diubah!"))}catch(F){await a("Gagal!",((j=(T=F.response)==null?void 0:T.data)==null?void 0:j.message)||"Gagal mengubah urutan"),D()}$.value=null};return(r,i)=>(g(),f("div",Ze,[m(ye,{"pending-count":E.value,"status-filter":S.value,onAdd:i[0]||(i[0]=o=>k.value=!0),"onUpdate:statusFilter":i[1]||(i[1]=o=>S.value=o)},null,8,["pending-count","status-filter"]),m(Ye,{items:R.value,loading:l.value,error:x.value,onAdd:i[2]||(i[2]=o=>k.value=!0),onEdit:z,onDelete:X,onToggle:W,onDragStart:i[3]||(i[3]=o=>$.value=o),onDrop:J},null,8,["items","loading","error"]),m(Fe,{show:k.value,"edit-mode":y.value,form:d.value,"photo-preview":w.value,submitting:M.value,onClose:V,onSubmit:O,onPhotoChange:H,onRemovePhoto:q},null,8,["show","edit-mode","form","photo-preview","submitting"])]))}},st=B(et,[["__scopeId","data-v-a6f864e4"]]);export{st as default};
