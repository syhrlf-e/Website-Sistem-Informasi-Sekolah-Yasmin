import{a as A,L as Y,d as Q}from"./app-F21Gw_vX.js";import{S as X,ab as Z,X as ee,ac as V,g as te,h as ae,a4 as re,y as se,ad as oe}from"./ui-BH4Jb6j-.js";import{i as g,k as u,l as e,e as c,u as k,D as le,m as w,r as p,w as D,f as ne,g as ie,j as N,t as $,B as T,O as E,W as K,F as W,C as R,A as q,T as de,P as ue,c as pe}from"./vendor-0BLfaBTW.js";import{I as ge}from"./ImageCropperModal-eOgvD4aF.js";const ce={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700"},be={class:"flex flex-col md:flex-row gap-4"},me={class:"flex-1 relative"},ye=["value"],xe=["value"],fe=["value"],ve={__name:"PrestasiListFilters",props:{search:String,category:String,tingkat:String},emits:["update:search","update:category","update:tingkat"],setup(d){return(v,o)=>(u(),g("div",ce,[e("div",be,[e("div",me,[c(k(X),{class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),e("input",{value:d.search,onInput:o[0]||(o[0]=f=>v.$emit("update:search",f.target.value)),type:"text",placeholder:"Cari prestasi...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,40,ye)]),e("select",{value:d.category,onChange:o[1]||(o[1]=f=>v.$emit("update:category",f.target.value)),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[...o[3]||(o[3]=[e("option",{value:""},"Semua Kategori",-1),e("option",{value:"Akademik"},"Akademik",-1),e("option",{value:"Olahraga"},"Olahraga",-1),e("option",{value:"Seni"},"Seni",-1)])],40,xe),e("select",{value:d.tingkat,onChange:o[2]||(o[2]=f=>v.$emit("update:tingkat",f.target.value)),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[...o[4]||(o[4]=[le('<option value="" data-v-e4aeb89e>Semua Tingkat</option><option value="Sekolah" data-v-e4aeb89e>Sekolah</option><option value="Kota" data-v-e4aeb89e>Kota</option><option value="Provinsi" data-v-e4aeb89e>Provinsi</option><option value="Nasional" data-v-e4aeb89e>Nasional</option><option value="Internasional" data-v-e4aeb89e>Internasional</option>',6)])],40,fe)])]))}},ke=A(ve,[["__scopeId","data-v-e4aeb89e"]]),he={class:"flex items-center justify-between"},we={__name:"PrestasiListHeader",emits:["add"],setup(d){return(v,o)=>(u(),g("div",he,[o[2]||(o[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},"Prestasi"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Kelola prestasi sekolah")],-1)),e("button",{onClick:o[0]||(o[0]=f=>v.$emit("add")),class:"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl font-poppins"},[c(k(Z),{class:"w-5 h-5"}),o[1]||(o[1]=w(" Tambah Prestasi ",-1))])]))}},_e=A(we,[["__scopeId","data-v-7e0034fb"]]),$e={key:0,class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4"},Ce={class:"bg-white dark:bg-gray-800 rounded-2xl max-w-3xl w-full max-h-[90vh] flex flex-col border border-gray-200 dark:border-gray-700 shadow-2xl"},Se={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0"},Pe={class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},Ie={class:"overflow-y-auto flex-1 p-6 modal-scrollbar"},Te={class:"space-y-4"},Fe={class:"grid grid-cols-2 gap-4"},Be=["max"],Ue={class:"space-y-2"},Le=["onUpdate:modelValue"],Ae=["onClick"],Me={key:0,class:"mb-3"},je={class:"relative group"},Ne=["src"],Ee={class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center gap-3"},Ge={key:0,class:"absolute top-2 left-2 px-2 py-1 bg-green-500 text-white text-xs rounded-full font-medium flex items-center gap-1"},Oe={class:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50/50 dark:bg-gray-900/50 flex-shrink-0"},Ve=["disabled"],De={__name:"PrestasiListModal",props:{show:Boolean,editMode:Boolean,form:Object,imagePreview:String,submitting:Boolean},emits:["close","submit","image-change","remove-image"],setup(d,{emit:v}){const o=d,f=v,t=p({...o.form}),y=p(null),i=p(!1),x=p(""),b=p(""),h=p(null);D(()=>o.form,s=>{t.value={...s},o.show||(b.value="",h.value=null,x.value="")},{deep:!0}),D(()=>o.show,s=>{s||(b.value="",h.value=null,x.value="")});const F=()=>t.value.peserta.push(""),B=s=>t.value.peserta.splice(s,1),I=s=>s?s.startsWith("http")||s.startsWith("/storage")||s.startsWith("data:")?s:s.includes("/")?`/storage/${s}`:`/storage/prestasi/${s}`:null,U=()=>{var s;(s=y.value)==null||s.click()},S=s=>{var _;const a=(_=s.target.files)==null?void 0:_[0];if(!a)return;if(!a.type.startsWith("image/")){alert("Pilih file gambar yang valid!");return}if(a.size>2*1024*1024){alert("Ukuran file maksimal 2MB!");return}const m=new FileReader;m.onload=P=>{x.value=P.target.result,i.value=!0},m.readAsDataURL(a)},M=s=>{h.value=s,b.value=URL.createObjectURL(s)},L=(s,a)=>{x.value=s},G=()=>{b.value="",h.value=null,x.value="",t.value.image=null,y.value&&(y.value.value=""),f("remove-image")},O=()=>{const s={...t.value};h.value&&(s._croppedImage=h.value),f("submit",s)};return(s,a)=>(u(),ne(ue,{to:"body"},[c(de,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","leave-active-class":"transition-opacity duration-200","leave-to-class":"opacity-0"},{default:ie(()=>[d.show?(u(),g("div",$e,[e("div",Ce,[e("div",Se,[e("h2",Pe,$(d.editMode?"Edit Prestasi":"Tambah Prestasi Baru"),1),e("button",{onClick:a[0]||(a[0]=m=>s.$emit("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[c(k(ee),{class:"w-5 h-5 text-gray-500"})])]),e("div",Ie,[e("div",Te,[e("div",null,[a[7]||(a[7]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Nama Prestasi "),e("span",{class:"text-red-500"},"*")],-1)),T(e("input",{"onUpdate:modelValue":a[1]||(a[1]=m=>t.value.nama_prestasi=m),type:"text",required:"",placeholder:"Contoh: Juara 1 Olimpiade Matematika Nasional",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[E,t.value.nama_prestasi]])]),e("div",Fe,[e("div",null,[a[9]||(a[9]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Kategori "),e("span",{class:"text-red-500"},"*")],-1)),T(e("select",{"onUpdate:modelValue":a[2]||(a[2]=m=>t.value.kategori=m),required:"",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins"},[...a[8]||(a[8]=[e("option",{value:""},"Pilih Kategori",-1),e("option",{value:"Akademik"},"Akademik",-1),e("option",{value:"Olahraga"},"Olahraga",-1),e("option",{value:"Seni"},"Seni",-1)])],512),[[K,t.value.kategori]])]),e("div",null,[a[11]||(a[11]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Tingkat "),e("span",{class:"text-red-500"},"*")],-1)),T(e("select",{"onUpdate:modelValue":a[3]||(a[3]=m=>t.value.tingkat=m),required:"",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins"},[...a[10]||(a[10]=[e("option",{value:""},"Pilih Tingkat",-1),e("option",{value:"Sekolah"},"Sekolah",-1),e("option",{value:"Kota"},"Kota",-1),e("option",{value:"Provinsi"},"Provinsi",-1),e("option",{value:"Nasional"},"Nasional",-1),e("option",{value:"Internasional"},"Internasional",-1)])],512),[[K,t.value.tingkat]])])]),e("div",null,[a[12]||(a[12]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Tahun "),e("span",{class:"text-red-500"},"*")],-1)),T(e("input",{"onUpdate:modelValue":a[4]||(a[4]=m=>t.value.tahun=m),type:"number",required:"",min:2e3,max:new Date().getFullYear()+1,placeholder:"2024",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins"},null,8,Be),[[E,t.value.tahun]])]),e("div",null,[a[13]||(a[13]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Peserta/Pemenang "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Ue,[(u(!0),g(W,null,R(t.value.peserta,(m,_)=>(u(),g("div",{key:_,class:"flex items-center gap-2"},[T(e("input",{"onUpdate:modelValue":P=>t.value.peserta[_]=P,type:"text",required:"",placeholder:"Nama peserta",class:"flex-1 px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins"},null,8,Le),[[E,t.value.peserta[_]]]),t.value.peserta.length>1?(u(),g("button",{key:0,type:"button",onClick:P=>B(_),class:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-xl"},[c(k(V),{class:"w-4 h-4"})],8,Ae)):N("",!0)]))),128)),e("button",{type:"button",onClick:F,class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-dashed border-gray-300 dark:border-gray-600 rounded-xl text-gray-600 dark:text-gray-400 font-poppins font-medium"},"+ Tambah Peserta")])]),e("div",null,[a[17]||(a[17]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Gambar Prestasi",-1)),b.value||d.editMode&&t.value.image?(u(),g("div",Me,[e("div",je,[e("img",{src:b.value||I(t.value.image),alt:"Preview",class:"w-full h-48 object-cover rounded-xl border border-gray-200 dark:border-gray-700"},null,8,Ne),e("div",Ee,[e("button",{type:"button",onClick:U,class:"px-4 py-2 bg-white/90 text-gray-900 rounded-lg font-medium text-sm flex items-center gap-2 hover:bg-white transition-colors"},[c(k(te),{class:"w-4 h-4"}),a[14]||(a[14]=w(" Ganti ",-1))]),e("button",{type:"button",onClick:G,class:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium text-sm flex items-center gap-2 hover:bg-red-600 transition-colors"},[c(k(V),{class:"w-4 h-4"}),a[15]||(a[15]=w(" Hapus ",-1))])]),b.value?(u(),g("div",Ge,[c(k(ae),{class:"w-3 h-3"}),a[16]||(a[16]=w(" Gambar dikrop (4:3) ",-1))])):N("",!0)])])):N("",!0),e("div",{class:q({hidden:b.value||d.editMode&&t.value.image})},[e("input",{ref_key:"fileInput",ref:y,type:"file",accept:"image/*",onChange:S,class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl font-poppins file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:bg-blue-50 file:text-blue-700 file:font-semibold"},null,544)],2),a[18]||(a[18]=e("p",{class:"mt-1 text-xs text-gray-500 font-poppins"}," Format: JPG, PNG, WEBP. Max: 2MB. Gambar akan di-crop otomatis ke rasio 4:3. ",-1))]),e("div",null,[a[19]||(a[19]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Deskripsi "),e("span",{class:"text-red-500"},"*")],-1)),T(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=m=>t.value.deskripsi=m),rows:"4",required:"",placeholder:"Deskripsi lengkap tentang prestasi...",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins resize-none"},null,512),[[E,t.value.deskripsi]])])])]),e("div",Oe,[e("button",{onClick:O,disabled:d.submitting,class:"w-full px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-400 text-white rounded-xl font-semibold font-poppins shadow-lg"},$(d.submitting?"Menyimpan...":d.editMode?"Update":"Simpan"),9,Ve)])])])):N("",!0)]),_:1}),c(ge,{show:i.value,"image-src":x.value,"aspect-ratio":4/3,onClose:a[6]||(a[6]=m=>i.value=!1),onCrop:M,onChangeImage:L},null,8,["show","image-src"])]))}},ze=A(De,[["__scopeId","data-v-ebd69ca8"]]),Ke={key:0,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 py-12"},We={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4"},Re={class:"text-sm text-red-600 dark:text-red-400 font-poppins"},qe={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},He={key:0,class:"p-12 text-center"},Je={key:1,class:"overflow-x-auto"},Ye={class:"w-full"},Qe={class:"divide-y divide-gray-200 dark:divide-gray-700"},Xe={class:"px-6 py-4 text-sm text-gray-900 dark:text-white font-poppins"},Ze={class:"px-6 py-4"},et={class:"flex items-center gap-3"},tt={class:"w-12 h-12 rounded-lg bg-gradient-to-br from-yellow-100 to-orange-100 dark:from-yellow-900/20 dark:to-orange-900/20 overflow-hidden flex-shrink-0"},at=["src","alt"],rt={key:1,class:"w-full h-full flex items-center justify-center"},st={class:"font-semibold text-gray-900 dark:text-white font-poppins line-clamp-1"},ot={class:"px-6 py-4"},lt={class:"px-6 py-4"},nt={class:"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400"},it={class:"px-6 py-4"},dt={class:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},ut={class:"font-poppins"},pt={class:"px-6 py-4 text-center text-sm text-gray-600 dark:text-gray-400 font-poppins"},gt={class:"px-6 py-4"},ct={class:"flex items-center justify-center gap-2"},bt=["onClick"],mt=["onClick"],yt={__name:"PrestasiListTable",props:{items:Array,loading:Boolean,error:String},emits:["edit","delete"],setup(d){const v=t=>t?t.startsWith("http")||t.startsWith("/storage")?t:t.includes("/")?`/storage/${t}`:`/storage/prestasi/${t}`:null,o=t=>({Akademik:"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400",Olahraga:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400",Seni:"bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400"})[t]||"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300",f=t=>{if(!t||t.length===0)return"-";if(typeof t=="string")try{t=JSON.parse(t)}catch{return t}return t.length===1?t[0]:`${t[0]} +${t.length-1} lainnya`};return(t,y)=>d.loading?(u(),g("div",Ke,[c(Y,{size:"md",color:"blue"})])):d.error?(u(),g("div",We,[e("p",Re,$(d.error),1)])):(u(),g("div",qe,[d.items.length===0?(u(),g("div",He,[...y[0]||(y[0]=[e("p",{class:"text-gray-600 dark:text-gray-400 font-poppins"},"Belum ada prestasi",-1)])])):(u(),g("div",Je,[e("table",Ye,[y[1]||(y[1]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"#"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Nama Prestasi"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Kategori"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Tingkat"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Peserta"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Tahun"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Action")])],-1)),e("tbody",Qe,[(u(!0),g(W,null,R(d.items,(i,x)=>(u(),g("tr",{key:i.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("td",Xe,$(x+1),1),e("td",Ze,[e("div",et,[e("div",tt,[i.image?(u(),g("img",{key:0,src:v(i.image),alt:i.nama_prestasi,class:"w-full h-full object-cover"},null,8,at)):(u(),g("div",rt,[c(k(re),{class:"w-6 h-6 text-yellow-400"})]))]),e("p",st,$(i.nama_prestasi),1)])]),e("td",ot,[e("span",{class:q(["inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium",o(i.kategori)])},$(i.kategori),3)]),e("td",lt,[e("span",nt,$(i.tingkat),1)]),e("td",it,[e("div",dt,[c(k(se),{class:"w-4 h-4"}),e("span",ut,$(f(i.peserta)),1)])]),e("td",pt,$(i.tahun),1),e("td",gt,[e("div",ct,[e("button",{onClick:b=>t.$emit("edit",i),class:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 hover:bg-blue-100",title:"Edit"},[c(k(oe),{class:"w-4 h-4"})],8,bt),e("button",{onClick:b=>t.$emit("delete",i.id),class:"p-2 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100",title:"Hapus"},[c(k(V),{class:"w-4 h-4"})],8,mt)])])]))),128))])])]))]))}},xt=A(yt,[["__scopeId","data-v-5bc593b8"]]),ft={class:"space-y-6"},vt={__name:"PrestasiList",setup(d){const{showSuccess:v,showError:o,confirmDelete:f}=Q(),t=p(""),y=p(""),i=p(""),x=p(!1),b=p(!1),h=p(!0),F=p(null),B=p(!1),I=p(null),U=p(null),S=p({nama_prestasi:"",kategori:"",tingkat:"",tahun:new Date().getFullYear(),peserta:[""],deskripsi:"",image:null}),M=p([]);D(x,r=>{document.body.style.overflow=r?"hidden":""});const L=async()=>{try{h.value=!0,F.value=null;const r=sessionStorage.getItem("admin_token"),n=await fetch("/api/yasmin-panel/prestasi",{headers:{Authorization:`Bearer ${r}`,Accept:"application/json"}});if(!n.ok)throw new Error("Gagal memuat data");const l=await n.json();M.value=l.success?l.data:l}catch{F.value="Gagal memuat data prestasi"}finally{h.value=!1}},G=pe(()=>M.value.filter(r=>{const n=r.nama_prestasi.toLowerCase().includes(t.value.toLowerCase()),l=y.value===""||r.kategori===y.value,C=i.value===""||r.tingkat===i.value;return n&&l&&C})),O=r=>{const n=r.target.files[0];if(!n)return;if(n.size>2*1024*1024){o("Ukuran File Terlalu Besar","Maksimal 2MB");return}if(!n.type.startsWith("image/")){o("Format File Salah","File harus gambar");return}U.value=n;const l=new FileReader;l.onload=C=>{I.value=C.target.result},l.readAsDataURL(n)},s=()=>{I.value=null,U.value=null,S.value.image=null},a=r=>{b.value=!0,S.value={id:r.id,nama_prestasi:r.nama_prestasi,kategori:r.kategori,tingkat:r.tingkat,tahun:r.tahun,peserta:Array.isArray(r.peserta)?[...r.peserta]:typeof r.peserta=="string"?JSON.parse(r.peserta):[""],deskripsi:r.deskripsi,image:r.image},x.value=!0},m=async r=>{if((await f("Hapus Prestasi?","Data tidak dapat dikembalikan!")).isConfirmed)try{const l=sessionStorage.getItem("admin_token"),C=await fetch(`/api/yasmin-panel/prestasi/${r}`,{method:"DELETE",headers:{Authorization:`Bearer ${l}`,Accept:"application/json"}});if(!C.ok)throw new Error("Gagal menghapus");const j=await C.json();await v("Berhasil!",j.message||"Prestasi berhasil dihapus!"),await L()}catch{await o("Gagal!","Gagal menghapus prestasi")}},_=async r=>{try{B.value=!0;const n=sessionStorage.getItem("admin_token"),l=new FormData;l.append("nama_prestasi",r.nama_prestasi),l.append("kategori",r.kategori),l.append("tingkat",r.tingkat),l.append("tahun",r.tahun),l.append("deskripsi",r.deskripsi),r.peserta.forEach((z,J)=>{z.trim()&&l.append(`peserta[${J}]`,z.trim())}),r._croppedImage&&l.append("image",r._croppedImage,"cropped.webp");const C=b.value?`/api/yasmin-panel/prestasi/${S.value.id}`:"/api/yasmin-panel/prestasi";b.value&&l.append("_method","PUT");const j=await fetch(C,{method:"POST",headers:{Authorization:`Bearer ${n}`,Accept:"application/json"},body:l});if(!j.ok)throw new Error("Gagal menyimpan");const H=await j.json();await v("Berhasil!",H.message||(b.value?"Prestasi berhasil diupdate!":"Prestasi berhasil ditambahkan!")),P(),await L()}catch{await o("Gagal!","Gagal menyimpan prestasi")}finally{B.value=!1}},P=()=>{x.value=!1,b.value=!1,I.value=null,U.value=null,S.value={nama_prestasi:"",kategori:"",tingkat:"",tahun:new Date().getFullYear(),peserta:[""],deskripsi:"",image:null},document.body.style.overflow=""};return L(),(r,n)=>(u(),g("div",ft,[c(_e,{onAdd:n[0]||(n[0]=l=>x.value=!0)}),c(ke,{search:t.value,"onUpdate:search":n[1]||(n[1]=l=>t.value=l),category:y.value,"onUpdate:category":n[2]||(n[2]=l=>y.value=l),tingkat:i.value,"onUpdate:tingkat":n[3]||(n[3]=l=>i.value=l)},null,8,["search","category","tingkat"]),c(xt,{items:G.value,loading:h.value,error:F.value,onEdit:a,onDelete:m},null,8,["items","loading","error"]),c(ze,{show:x.value,"edit-mode":b.value,form:S.value,"image-preview":I.value,submitting:B.value,onClose:P,onSubmit:_,onImageChange:O,onRemoveImage:s},null,8,["show","edit-mode","form","image-preview","submitting"])]))}},$t=A(vt,[["__scopeId","data-v-49612b26"]]);export{$t as default};
