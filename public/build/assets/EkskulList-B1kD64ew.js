import{a as ae,B as _e,L as Ce,c as ne,d as Se}from"./app-F21Gw_vX.js";import{ab as Ee,S as Ae,a3 as Pe,g as xe,am as Ie,ad as Be,ac as le,X as De,s as je,h as Me,ai as Re,R as be,t as Le}from"./ui-BH4Jb6j-.js";import{i,k as l,l as e,e as m,m as C,u as v,D as Ue,F as Z,C as ee,f as se,j as D,t as w,A as te,r as b,w as ie,g as me,B as _,O as M,W as Fe,X as oe,T as ye,P as Ge,c as Ne,o as Oe}from"./vendor-0BLfaBTW.js";import{I as Ke}from"./ImageCropperModal-eOgvD4aF.js";const Ve={class:"flex items-center justify-between"},We={__name:"EkskulListHeader",emits:["add"],setup(u){return(S,g)=>(l(),i("div",Ve,[g[2]||(g[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"}," Ekstrakurikuler "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Kelola semua ekstrakurikuler")],-1)),e("button",{onClick:g[0]||(g[0]=y=>S.$emit("add")),class:"flex items-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white rounded-xl font-medium transition-colors duration-200 shadow-lg hover:shadow-xl font-poppins"},[m(v(Ee),{class:"w-5 h-5"}),g[1]||(g[1]=C(" Tambah Ekskul ",-1))])]))}},He=ae(We,[["__scopeId","data-v-96a38892"]]),ze={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700"},Qe={class:"flex flex-col md:flex-row gap-4"},Je={class:"flex-1 relative"},Xe=["value"],qe=["value"],Ye=["value"],Ze={__name:"EkskulListFilters",props:{searchQuery:{type:String,default:""},badgeFilter:{type:String,default:""},statusFilter:{type:String,default:""}},emits:["update:searchQuery","update:badgeFilter","update:statusFilter"],setup(u){return(S,g)=>(l(),i("div",ze,[e("div",Qe,[e("div",Je,[m(v(Ae),{class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),e("input",{value:u.searchQuery,onInput:g[0]||(g[0]=y=>S.$emit("update:searchQuery",y.target.value)),type:"text",placeholder:"Cari ekstrakurikuler...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,40,Xe)]),e("select",{value:u.badgeFilter,onChange:g[1]||(g[1]=y=>S.$emit("update:badgeFilter",y.target.value)),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[...g[3]||(g[3]=[Ue('<option value="" data-v-7ec6453e>Semua Kategori</option><option value="Akademik" data-v-7ec6453e>Akademik</option><option value="Olahraga" data-v-7ec6453e>Olahraga</option><option value="Seni" data-v-7ec6453e>Seni</option><option value="Kepemimpinan" data-v-7ec6453e>Kepemimpinan</option>',5)])],40,qe),e("select",{value:u.statusFilter,onChange:g[2]||(g[2]=y=>S.$emit("update:statusFilter",y.target.value)),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[...g[4]||(g[4]=[e("option",{value:""},"Semua Status",-1),e("option",{value:"1"},"Aktif",-1),e("option",{value:"0"},"Nonaktif",-1)])],40,Ye)])]))}},et=ae(Ze,[["__scopeId","data-v-7ec6453e"]]),tt={class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},at={key:0,class:"p-12 text-center"},rt={class:"w-16 h-16 mx-auto mb-4 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center"},st={key:1,class:"overflow-x-auto"},nt={class:"w-full"},ot={class:"divide-y divide-gray-200 dark:divide-gray-700"},lt={class:"px-6 py-4"},it={class:"w-16 h-16 rounded-lg overflow-hidden flex-shrink-0 bg-gray-100 dark:bg-gray-700 flex items-center justify-center"},dt=["src","alt"],ut={class:"px-6 py-4"},gt={class:"font-semibold text-gray-900 dark:text-white font-poppins"},pt={key:0,class:"text-xs text-gray-900 dark:text-white font-poppins italic mt-0.5"},ct={class:"px-6 py-4"},bt={class:"px-6 py-4"},mt={class:"flex items-center justify-center"},yt=["onClick","disabled"],xt={class:"text-xs font-semibold font-poppins"},ft={class:"px-6 py-4"},vt={class:"text-center"},kt={key:0},ht={key:0,class:"inline-block mt-1 px-2 py-0.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 text-xs font-semibold rounded-full"},wt={key:1,class:"text-sm text-gray-400 dark:text-gray-500 font-poppins"},Tt={class:"px-6 py-4"},$t={class:"text-center"},_t={key:0,class:"text-sm text-gray-900 dark:text-white font-poppins font-semibold"},Ct={key:1,class:"text-sm text-gray-400 dark:text-gray-500 font-poppins"},St={class:"px-6 py-4"},Et={class:"flex items-center justify-center gap-2"},At=["onClick"],Pt=["onClick"],It={__name:"EkskulListTable",props:{items:{type:Array,required:!0}},emits:["edit","delete","toggle-status"],setup(u){const S=c=>c?c.startsWith("http")?c:`/storage/${c}`:null,g=c=>({Akademik:"blue",Olahraga:"green",Seni:"purple",Kepemimpinan:"orange"})[c]||"gray",y=c=>c.registration_deadline?new Date(c.registration_deadline)<new Date:!1,r=c=>c?new Date(c).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"}):"-";return(c,k)=>(l(),i("div",tt,[u.items.length===0?(l(),i("div",at,[e("div",rt,[m(v(Pe),{class:"w-8 h-8 text-gray-400"})]),k[0]||(k[0]=e("p",{class:"text-gray-600 dark:text-gray-400 font-poppins"},"Tidak ada ekstrakurikuler",-1))])):(l(),i("div",st,[e("table",nt,[k[1]||(k[1]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Preview"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Nama Ekskul"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Kategori"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Status Pendaftaran"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Batas Pendaftaran"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Maksimal Peserta"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"},"Action")])],-1)),e("tbody",ot,[(l(!0),i(Z,null,ee(u.items,d=>(l(),i("tr",{key:d.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150"},[e("td",lt,[e("div",it,[d.gambar?(l(),i("img",{key:0,src:S(d.gambar),alt:d.nama,class:"w-full h-full object-cover"},null,8,dt)):(l(),se(v(xe),{key:1,class:"w-6 h-6 text-gray-400"}))])]),e("td",ut,[e("div",null,[e("p",gt,w(d.nama),1),d.tagline?(l(),i("p",pt,' "'+w(d.tagline)+'" ',1)):D("",!0)])]),e("td",ct,[m(_e,{label:d.badge,variant:g(d.badge),size:"sm"},null,8,["label","variant"])]),e("td",bt,[e("div",mt,[e("button",{onClick:z=>c.$emit("toggle-status",d),disabled:y(d),class:te(["px-3 py-2 rounded-lg transition-colors duration-200 group flex items-center gap-2",[y(d)?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 cursor-not-allowed opacity-75":d.enable_registration?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 hover:bg-green-100":"bg-gray-50 dark:bg-gray-900/20 text-gray-600 dark:text-gray-400 hover:bg-gray-100"]])},[m(v(Ie),{class:"w-4 h-4 group-hover:scale-110 transition-transform"}),e("span",xt,w(y(d)?"EXPIRED":d.enable_registration?"BUKA":"TUTUP"),1)],10,yt)])]),e("td",ft,[e("div",vt,[d.registration_deadline?(l(),i("div",kt,[e("p",{class:te(["text-sm font-poppins",y(d)?"text-red-600 dark:text-red-400 font-semibold":"text-gray-900 dark:text-white"])},w(r(d.registration_deadline)),3),y(d)?(l(),i("span",ht," Sudah Lewat ")):D("",!0)])):(l(),i("p",wt,"-"))])]),e("td",Tt,[e("div",$t,[d.max_participants?(l(),i("p",_t,w(d.max_participants)+" orang ",1)):(l(),i("p",Ct,"-"))])]),e("td",St,[e("div",Et,[e("button",{onClick:z=>c.$emit("edit",d),class:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 hover:bg-blue-100 transition-colors duration-200 group",title:"Edit"},[m(v(Be),{class:"w-4 h-4 group-hover:scale-110 transition-transform"})],8,At),e("button",{onClick:z=>c.$emit("delete",d.id),class:"p-2 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100 transition-colors duration-200 group",title:"Hapus"},[m(v(le),{class:"w-4 h-4 group-hover:scale-110 transition-transform"})],8,Pt)])])]))),128))])])]))]))}},Bt=ae(It,[["__scopeId","data-v-d9f3c19e"]]),Dt={key:0,class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4"},jt={class:"flex items-stretch gap-4 my-auto"},Mt={class:"bg-white dark:bg-gray-800 rounded-2xl w-[600px] flex flex-col border border-gray-200 dark:border-gray-700 shadow-2xl transition-all duration-300",style:{"max-height":"calc(100vh - 2rem)"}},Rt={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0"},Lt={class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},Ut={class:"overflow-y-auto flex-1 p-6 modal-scrollbar"},Ft={class:"space-y-4"},Gt={class:"grid grid-cols-2 gap-4"},Nt={class:"grid grid-cols-2 gap-4"},Ot={class:"grid grid-cols-2 gap-2"},Kt={class:"relative"},Vt={key:0,class:"text-gray-900 dark:text-white text-sm truncate"},Wt={key:1,class:"text-gray-400 text-sm"},Ht={key:0,class:"absolute z-10 mt-2 w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-3"},zt={class:"space-y-2"},Qt=["value"],Jt={class:"text-sm text-gray-900 dark:text-white"},Xt={class:"relative"},qt={key:0,class:"text-gray-900 dark:text-white text-sm"},Yt={key:1,class:"text-gray-400 text-sm"},Zt={key:0,class:"absolute z-10 mt-2 w-64 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-4"},ea={class:"grid grid-cols-2 gap-3"},ta={class:"h-32 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg"},aa=["onClick"],ra={class:"h-32 overflow-y-auto border border-gray-200 dark:border-gray-700 rounded-lg"},sa=["onClick"],na={key:0,class:"mb-3"},oa={class:"relative group"},la=["src"],ia={class:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity rounded-xl flex items-center justify-center gap-3"},da={key:0,class:"absolute top-2 left-2 px-2 py-1 bg-green-500 text-white text-xs rounded-full font-medium flex items-center gap-1"},ua={class:"space-y-2"},ga=["onUpdate:modelValue"],pa=["onClick"],ca={class:"border-t pt-4 mt-4"},ba={class:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-900 rounded-xl"},ma={class:"relative inline-flex items-center cursor-pointer"},ya={class:"flex items-center gap-3"},xa={class:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50/50 flex-shrink-0"},fa={class:"flex items-center gap-3"},va=["disabled"],ka=["disabled"],ha={key:0,class:"bg-white dark:bg-gray-800 rounded-2xl w-[350px] flex flex-col border border-gray-200 dark:border-gray-700 shadow-2xl overflow-hidden",style:{"max-height":"calc(100vh - 2rem)"}},wa={class:"overflow-y-auto flex-1 p-6 modal-scrollbar space-y-6"},Ta=["value"],$a={key:1,type:"button",disabled:"",class:"w-full px-4 py-3 bg-blue-400 text-white rounded-xl font-semibold flex items-center justify-center gap-2 cursor-wait"},_a={class:"space-y-2"},Ca={__name:"EkskulListModal",props:{show:Boolean,editMode:Boolean,form:Object,submitting:Boolean,canGenerateToken:Boolean,generatingToken:Boolean,tokenCopied:Boolean,imagePreview:String},emits:["close","submit","generate-token","copy-token","image-crop","remove-image"],setup(u,{emit:S}){const g=u,y=S,r=b({...g.form}),c=b(!1),k=b(!1),d=b(null),z=["Senin","Selasa","Rabu","Kamis","Jumat","Sabtu","Minggu"],J=[];for(let n=6;n<=22;n++)for(let t=0;t<60;t+=30)J.push(`${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}`);ie(()=>g.form,n=>{r.value={...n,benefits:[...n.benefits||[""]]}},{immediate:!0});const re=n=>n?n.startsWith("http")||n.startsWith("/storage")?n:`/storage/${n}`:null,L=()=>r.value.benefits.push(""),X=n=>r.value.benefits.splice(n,1),U=b(!1),R=b(""),E=b(""),F=()=>{var n;(n=d.value)==null||n.click()},K=n=>{var A;const t=(A=n.target.files)==null?void 0:A[0];if(!t)return;if(!t.type.startsWith("image/")){alert("Pilih file gambar yang valid!");return}if(t.size>2*1024*1024){alert("Ukuran file maksimal 2MB!");return}const s=new FileReader;s.onload=Q=>{R.value=Q.target.result,U.value=!0},s.readAsDataURL(t),n.target.value=""},j=n=>{E.value=URL.createObjectURL(n),y("image-crop",n)},G=n=>{R.value=n},q=()=>{E.value="",R.value="",r.value.gambar=null,d.value&&(d.value.value=""),y("remove-image")},N=()=>y("submit",r.value);return ie(()=>g.show,n=>{n||(E.value="",R.value="")}),(n,t)=>(l(),se(Ge,{to:"body"},[m(ye,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:me(()=>[u.show?(l(),i("div",Dt,[e("div",jt,[e("div",Mt,[e("div",Rt,[e("h2",Lt,w(u.editMode?"Edit Ekstrakurikuler":"Tambah Ekstrakurikuler Baru"),1),e("button",{onClick:t[0]||(t[0]=s=>n.$emit("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[m(v(De),{class:"w-5 h-5 text-gray-500"})])]),e("div",Ut,[e("div",Ft,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Nama Ekstrakurikuler "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.nama=s),type:"text",required:"",placeholder:"Contoh: English Club",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[M,r.value.nama]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Tagline",-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.tagline=s),type:"text",placeholder:"Contoh: Speak English with Confidence!",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[M,r.value.tagline]])]),e("div",Gt,[e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Pembina "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.pembina=s),type:"text",required:"",placeholder:"Nama Pembina",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[M,r.value.pembina]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Badge/Kategori "),e("span",{class:"text-red-500"},"*")],-1)),_(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.badge=s),required:"",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-emerald-500 text-gray-900 dark:text-white font-poppins"},[...t[25]||(t[25]=[e("option",{value:""},"Pilih Badge",-1),e("option",{value:"Akademik"},"Akademik",-1),e("option",{value:"Olahraga"},"Olahraga",-1),e("option",{value:"Seni"},"Seni",-1),e("option",{value:"Kepemimpinan"},"Kepemimpinan",-1)])],512),[[Fe,r.value.badge]])])]),e("div",Nt,[e("div",Ot,[e("div",Kt,[t[27]||(t[27]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Hari "),e("span",{class:"text-red-500"},"*")],-1)),e("button",{type:"button",onClick:t[5]||(t[5]=s=>c.value=!c.value),class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-left flex items-center justify-between"},[r.value.selectedDays.length>0?(l(),i("span",Vt,w(r.value.selectedDays.join(", ")),1)):(l(),i("span",Wt,"Pilih Hari")),m(v(je),{class:"w-4 h-4 text-gray-400 flex-shrink-0"})]),c.value?(l(),i("div",Ht,[e("div",zt,[(l(),i(Z,null,ee(z,s=>e("label",{key:s,class:"flex items-center gap-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg cursor-pointer"},[_(e("input",{type:"checkbox",value:s,"onUpdate:modelValue":t[6]||(t[6]=A=>r.value.selectedDays=A),class:"w-4 h-4 text-blue-600"},null,8,Qt),[[oe,r.value.selectedDays]]),e("span",Jt,w(s),1)])),64))]),e("button",{type:"button",onClick:t[7]||(t[7]=s=>c.value=!1),class:"mt-3 w-full px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold"},"Selesai")])):D("",!0)]),e("div",Xt,[t[30]||(t[30]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Jam "),e("span",{class:"text-red-500"},"*")],-1)),e("button",{type:"button",onClick:t[8]||(t[8]=s=>k.value=!k.value),class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-left flex items-center justify-between"},[r.value.scheduleStartTime&&r.value.scheduleEndTime?(l(),i("span",qt,w(r.value.scheduleStartTime)+"-"+w(r.value.scheduleEndTime),1)):(l(),i("span",Yt,"Pilih Jam"))]),k.value?(l(),i("div",Zt,[e("div",ea,[e("div",null,[t[28]||(t[28]=e("label",{class:"block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 text-center"},"Jam Mulai",-1)),e("div",ta,[(l(),i(Z,null,ee(J,s=>e("button",{key:"start-"+s,type:"button",onClick:A=>r.value.scheduleStartTime=s,class:te(["w-full px-3 py-2 text-sm text-gray-900 dark:text-white",r.value.scheduleStartTime===s?"bg-blue-600 !text-white font-semibold":"hover:bg-gray-100 dark:hover:bg-gray-700"])},w(s),11,aa)),64))])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2 text-center"},"Jam Selesai",-1)),e("div",ra,[(l(),i(Z,null,ee(J,s=>e("button",{key:"end-"+s,type:"button",onClick:A=>r.value.scheduleEndTime=s,class:te(["w-full px-3 py-2 text-sm text-gray-900 dark:text-white",r.value.scheduleEndTime===s?"bg-blue-600 !text-white font-semibold":"hover:bg-gray-100 dark:hover:bg-gray-700"])},w(s),11,sa)),64))])])]),e("button",{type:"button",onClick:t[9]||(t[9]=s=>k.value=!1),class:"mt-3 w-full px-3 py-2 bg-blue-600 text-white rounded-lg text-sm font-semibold"},"Selesai")])):D("",!0)])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Lokasi "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[10]||(t[10]=s=>r.value.lokasi=s),type:"text",required:"",placeholder:"Contoh: Ruang Lab Bahasa",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[M,r.value.lokasi]])])]),e("div",null,[t[37]||(t[37]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Gambar",-1)),E.value||u.imagePreview||u.editMode&&r.value.gambar?(l(),i("div",na,[e("div",oa,[e("img",{src:E.value||u.imagePreview||re(r.value.gambar),alt:"Preview",class:"w-full h-48 object-cover rounded-xl border border-gray-200 dark:border-gray-700"},null,8,la),e("div",ia,[e("button",{type:"button",onClick:F,class:"px-4 py-2 bg-white/90 text-gray-900 rounded-lg font-medium text-sm flex items-center gap-2 hover:bg-white transition-colors"},[m(v(xe),{class:"w-4 h-4"}),t[32]||(t[32]=C(" Ganti ",-1))]),e("button",{type:"button",onClick:q,class:"px-4 py-2 bg-red-500 text-white rounded-lg font-medium text-sm flex items-center gap-2 hover:bg-red-600 transition-colors"},[m(v(le),{class:"w-4 h-4"}),t[33]||(t[33]=C(" Hapus ",-1))])]),E.value?(l(),i("div",da,[m(v(Me),{class:"w-3 h-3"}),t[34]||(t[34]=C(" Gambar dikrop (16:9) ",-1))])):D("",!0)])])):D("",!0),!E.value&&!u.imagePreview&&!(u.editMode&&r.value.gambar)?(l(),i("div",{key:1,class:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-6 text-center hover:border-blue-500 dark:hover:border-blue-400 transition-colors duration-200 cursor-pointer",onClick:F},[m(v(Re),{class:"w-10 h-10 text-gray-400 mx-auto mb-2"}),t[35]||(t[35]=e("p",{class:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 font-poppins"}," Klik untuk upload gambar ",-1)),t[36]||(t[36]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400"},"PNG, JPG, WEBP maks 2MB. Akan di-crop ke rasio 16:9.",-1))])):D("",!0),e("input",{ref_key:"fileInput",ref:d,type:"file",accept:"image/*",class:"hidden",onChange:K},null,544)]),e("div",null,[t[38]||(t[38]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[C(" Deskripsi "),e("span",{class:"text-red-500"},"*")],-1)),_(e("textarea",{"onUpdate:modelValue":t[11]||(t[11]=s=>r.value.deskripsi=s),rows:"4",required:"",placeholder:"Deskripsi lengkap...",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl resize-none text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[M,r.value.deskripsi]])]),e("div",null,[t[39]||(t[39]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},"Yang Kamu Dapatkan",-1)),e("div",ua,[(l(!0),i(Z,null,ee(r.value.benefits,(s,A)=>(l(),i("div",{key:"benefit-"+A,class:"flex items-center gap-2"},[_(e("input",{"onUpdate:modelValue":Q=>r.value.benefits[A]=Q,type:"text",placeholder:"Contoh: Meningkatkan kemampuan...",class:"flex-1 px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"},null,8,ga),[[M,r.value.benefits[A]]]),r.value.benefits.length>1?(l(),i("button",{key:0,type:"button",onClick:Q=>X(A),class:"p-3 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-xl"},[m(v(le),{class:"w-4 h-4"})],8,pa)):D("",!0)]))),128)),e("button",{type:"button",onClick:L,class:"w-full px-4 py-3 bg-gray-50 border border-dashed border-gray-300 rounded-xl text-gray-600"},"+ Tambah Benefit")])]),e("div",ca,[e("div",ba,[t[41]||(t[41]=e("div",null,[e("p",{class:"font-semibold text-gray-900 dark:text-white"}," Pengaturan Pendaftaran "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Aktifkan untuk menampilkan panel pengaturan")],-1)),e("label",ma,[_(e("input",{"onUpdate:modelValue":t[12]||(t[12]=s=>r.value.enableRegistration=s),type:"checkbox",class:"sr-only peer"},null,512),[[oe,r.value.enableRegistration]]),t[40]||(t[40]=e("div",{class:"w-11 h-6 bg-gray-200 peer-checked:bg-blue-600 rounded-full peer after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full"},null,-1))])])]),e("div",ya,[_(e("input",{"onUpdate:modelValue":t[13]||(t[13]=s=>r.value.is_active=s),type:"checkbox",id:"is_active",class:"w-5 h-5 text-blue-600"},null,512),[[oe,r.value.is_active]]),t[42]||(t[42]=e("label",{for:"is_active",class:"text-sm font-semibold text-gray-900 dark:text-white"},"Aktifkan Ekstrakurikuler",-1))])])]),e("div",xa,[e("div",fa,[e("button",{onClick:N,disabled:u.submitting,class:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 disabled:from-gray-400 disabled:to-gray-400 text-white rounded-xl font-semibold"},w(u.submitting?"Menyimpan...":u.editMode?"Update":"Simpan"),9,va),e("button",{type:"button",onClick:t[14]||(t[14]=s=>n.$emit("close")),disabled:u.submitting,class:"px-6 py-3 bg-gray-100 text-gray-700 rounded-xl font-semibold"},"Batal",8,ka)])])]),m(ye,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 translate-x-4 w-0","enter-to-class":"opacity-100 translate-x-0 w-[350px]","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 translate-x-0 w-[350px]","leave-to-class":"opacity-0 translate-x-4 w-0"},{default:me(()=>[r.value.enableRegistration?(l(),i("div",ha,[t[51]||(t[51]=e("div",{class:"p-6 border-b border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0"},[e("h3",{class:"text-lg font-bold text-gray-900 dark:text-white font-poppins"}," Pengaturan Pendaftaran "),e("p",{class:"text-gray-600 dark:text-gray-400 text-sm mt-1"},"Konfigurasi pendaftaran siswa")],-1)),e("div",wa,[e("div",null,[t[45]||(t[45]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2"},"Kode Registrasi",-1)),e("input",{value:u.form.registrationToken,type:"text",readonly:"",placeholder:"Klik 'Generate' untuk membuat kode",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl font-mono text-sm text-gray-900 dark:text-white mb-3"},null,8,Ta),u.canGenerateToken&&!u.generatingToken?(l(),i("button",{key:0,onClick:t[15]||(t[15]=s=>n.$emit("generate-token",r.value.nama)),type:"button",class:"w-full px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold flex items-center justify-center gap-2 transition-colors"},[m(v(be),{class:"w-4 h-4"}),t[43]||(t[43]=C(" Generate Kode ",-1))])):u.generatingToken?(l(),i("button",$a,[m(v(be),{class:"w-4 h-4 animate-spin"}),t[44]||(t[44]=C(" Generating... ",-1))])):(l(),i("button",{key:2,onClick:t[16]||(t[16]=s=>n.$emit("copy-token")),type:"button",class:te(["w-full px-4 py-3 rounded-xl font-semibold flex items-center justify-center gap-2 transition-colors",u.tokenCopied?"bg-green-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"])},[u.tokenCopied?D("",!0):(l(),se(v(Le),{key:0,class:"w-4 h-4"})),C(" "+w(u.tokenCopied?"âœ“ Copied!":"Copy Kode"),1)],2)),t[46]||(t[46]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},"ðŸ’¡ Kode berlaku 24 jam",-1))]),e("div",null,[t[47]||(t[47]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2"},"Maksimal Peserta",-1)),_(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>r.value.maxParticipants=s),type:"number",min:"1",placeholder:"30",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white"},null,512),[[M,r.value.maxParticipants,void 0,{number:!0}]])]),e("div",null,[t[48]||(t[48]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2"},"Batas Waktu Pendaftaran",-1)),e("div",_a,[_(e("input",{"onUpdate:modelValue":t[18]||(t[18]=s=>r.value.deadlineDate=s),type:"date",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white"},null,512),[[M,r.value.deadlineDate]]),_(e("input",{"onUpdate:modelValue":t[19]||(t[19]=s=>r.value.deadlineTime=s),type:"time",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white"},null,512),[[M,r.value.deadlineTime]])])]),e("div",null,[t[49]||(t[49]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2"},"WhatsApp Admin",-1)),_(e("input",{"onUpdate:modelValue":t[20]||(t[20]=s=>r.value.whatsappAdmin=s),type:"text",placeholder:"628xxxxxxxxxx",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white"},null,512),[[M,r.value.whatsappAdmin]]),t[50]||(t[50]=e("p",{class:"mt-2 text-xs text-gray-500 dark:text-gray-400"},"ðŸ“± Nomor WhatsApp untuk notifikasi ke siswa saat approved",-1))])])])):D("",!0)]),_:1})])])):D("",!0)]),_:1}),m(Ke,{show:U.value,"image-src":R.value,"aspect-ratio":16/9,onClose:t[21]||(t[21]=s=>U.value=!1),onCrop:j,onChangeImage:G},null,8,["show","image-src"])]))}},Sa=ae(Ca,[["__scopeId","data-v-7c21f55c"]]),Ea={class:"space-y-6"},Aa={key:0,class:"py-20"},Pa={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-6 text-center"},Ia={class:"text-red-600 dark:text-red-400 font-poppins"},Ba={__name:"EkskulList",setup(u){const S=b(""),g=b(""),y=b(""),r=b(!1),{showSuccess:c,showError:k,showWarning:d,confirmDelete:z,showLoading:J,close:re}=Se(),L=b(!1),X=b(!0),U=b(null),R=b(!1);b(null);const E=b(null),F=b(null),K=b(null),j=b(!0),G=b(!1),q=b(!1),N=b([]),n=b({nama:"",tagline:"",badge:"",deskripsi:"",benefits:[""],jadwal:"",pembina:"",lokasi:"",is_active:!0,gambar:null,selectedDays:[],scheduleStartTime:"",scheduleEndTime:"",enableRegistration:!1,registrationToken:"",maxParticipants:null,registrationDeadline:"",deadlineDate:"",deadlineTime:"",whatsappAdmin:"",tokenGeneratedAt:null,canGenerateNextAt:null});ie(r,a=>{document.body.style.overflow=a?"hidden":""});const t=async()=>{try{X.value=!0,U.value=null;const a=await ne.get("/yasmin-panel/ekstrakurikuler");N.value=a.data.success?a.data.data:a.data}catch{U.value="Gagal memuat data ekstrakurikuler"}finally{X.value=!1}},s=Ne(()=>N.value.filter(a=>{const p=a.nama||"",o=a.badge||"",T=p.toLowerCase().includes(S.value.toLowerCase()),P=g.value===""||o===g.value,f=y.value===""||a.is_active===(y.value==="1");return T&&P&&f})),A=async a=>{var ge,pe,ce;G.value=!0;const p=["TIGER","EAGLE","WOLF","LION","HAWK","BEAR","FOX","SHARK","DRAGON","PHOENIX","FALCON","PANTHER","COBRA","VIPER","RAVEN","THUNDER","STORM","BLAZE","FROST","SHADOW","LIGHT","STAR","MOON","SUN","WIND","FIRE","WATER","EARTH","SKY","OCEAN"],o="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",T=a?a.toUpperCase().replace(/\s/g,"").substring(0,10):"EKSKUL",P=(I,B)=>{let h="";for(let $=0;$<I;$++)h+=B.charAt(Math.floor(Math.random()*B.length));return h};let f=0;const x=15,V="ABCDEFGHIJKLMNOPQRSTUVWXYZ",ue="0123456789",O=setInterval(()=>{const I=P(T.length,V),B=P(6,V),h=P(2,ue);n.value.registrationToken=`${I}-${B}-${h}`,f++,f>=x&&clearInterval(O)},50);if(!n.value.id){const I=p[Math.floor(Math.random()*p.length)],B=Math.floor(Math.random()*90)+10,h=`${T}-${I}-${B}`;setTimeout(()=>{clearInterval(O);for(let $=0;$<=h.length;$++)setTimeout(()=>{let W=h.substring(0,$);for(let H=$;H<h.length;H++)h[H]==="-"?W+="-":W+=o.charAt(Math.floor(Math.random()*o.length));n.value.registrationToken=W},$*25);setTimeout(()=>{n.value.registrationToken=h,j.value=!1,G.value=!1},h.length*25+100)},x*50);return}const Y=n.value.registrationToken;try{const I=await ne.post(`/yasmin-panel/ekstrakurikuler/${n.value.id}/generate-token`);if(clearInterval(O),I.data.success){const B=I.data.data.token,h=B.length;for(let $=0;$<=h;$++)setTimeout(()=>{let W=B.substring(0,$);for(let H=$;H<h;H++)B[H]==="-"?W+="-":W+=o.charAt(Math.floor(Math.random()*o.length));n.value.registrationToken=W},$*25);setTimeout(()=>{n.value.registrationToken=B,n.value.tokenGeneratedAt=I.data.data.generated_at,j.value=!1,G.value=!1},h*25+100)}}catch(I){clearInterval(O),n.value.registrationToken=Y,G.value=!1,((ge=I.response)==null?void 0:ge.status)===429?await d("Cooldown Active!","Kode hanya dapat di-generate setiap 24 jam."):await k("Gagal!",((ce=(pe=I.response)==null?void 0:pe.data)==null?void 0:ce.message)||"Gagal generate kode")}},Q=async()=>{if(n.value.registrationToken)try{await navigator.clipboard.writeText(n.value.registrationToken),q.value=!0,setTimeout(()=>{q.value=!1},2e3)}catch{}},fe=a=>{K.value=a,E.value=URL.createObjectURL(a)},ve=()=>{E.value=null,F.value=null,K.value=null,n.value.gambar=null},ke=a=>{if(L.value=!0,E.value=null,F.value=null,!a.registration_token)j.value=!0;else if(a.token_expires_at){const x=new Date(a.token_expires_at);j.value=new Date>=x}else if(a.token_generated_at){const x=new Date(a.token_generated_at),V=new Date(x.getTime()+1440*60*1e3);j.value=new Date>=V}else j.value=!0;let p=[],o="",T="";if(a.jadwal){const x=a.jadwal.split(",");if(x.length>=2){p=x.slice(0,-1).join(",").trim().split(",").map(Y=>Y.trim()).filter(Y=>Y);const O=x[x.length-1].trim().match(/(\d{2}:\d{2})-(\d{2}:\d{2})/);O&&(o=O[1],T=O[2])}}let P="",f="";if(a.registration_deadline){const x=new Date(a.registration_deadline);P=x.toISOString().split("T")[0],f=x.toTimeString().slice(0,5)}n.value={id:a.id,nama:a.nama,tagline:a.tagline||"",badge:a.badge||"",deskripsi:a.deskripsi,benefits:Array.isArray(a.benefits)&&a.benefits.length>0?[...a.benefits]:[""],jadwal:a.jadwal,pembina:a.pembina,lokasi:a.lokasi,is_active:a.is_active,gambar:a.gambar,selectedDays:p,scheduleStartTime:o,scheduleEndTime:T,enableRegistration:!!a.enable_registration,registrationToken:a.registration_token||"",maxParticipants:a.max_participants||null,registrationDeadline:a.registration_deadline||"",deadlineDate:P,deadlineTime:f,whatsappAdmin:a.whatsapp_admin||"",tokenGeneratedAt:a.token_generated_at||null,canGenerateNextAt:a.token_generated_at?new Date(new Date(a.token_generated_at).getTime()+1440*60*1e3).toISOString():null},r.value=!0},he=async a=>{var T,P;const p=a.enable_registration,o=N.value.findIndex(f=>f.id===a.id);o!==-1&&(N.value[o].enable_registration=!p);try{const f=await ne.put(`/yasmin-panel/ekstrakurikuler/${a.id}/toggle-registration`);f.data.success&&o!==-1&&(N.value[o]=f.data.data,await Swal.fire({title:"Berhasil!",text:f.data.message,icon:"success",timer:1500,showConfirmButton:!1}))}catch(f){o!==-1&&(N.value[o].enable_registration=p),await k("Gagal!",((P=(T=f.response)==null?void 0:T.data)==null?void 0:P.message)||"Gagal mengubah status")}},we=async a=>{if((await z("Hapus Ekstrakurikuler?","Data tidak dapat dikembalikan!")).isConfirmed)try{const o=sessionStorage.getItem("admin_token");if(!(await fetch(`/api/yasmin-panel/ekstrakurikuler/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`,Accept:"application/json"}})).ok)throw new Error("Gagal menghapus");await c("Berhasil!","Ekstrakurikuler dihapus!"),await t()}catch{await k("Gagal!","Gagal menghapus ekstrakurikuler")}},Te=async a=>{r.value=!1,document.body.style.overflow="",await new Promise(p=>setTimeout(p,200)),J(L.value?"Memperbarui Data...":"Menyimpan Data...");try{R.value=!0;const p=sessionStorage.getItem("admin_token"),o=new FormData;o.append("nama",a.nama),o.append("tagline",a.tagline||""),o.append("badge",a.badge),o.append("deskripsi",a.deskripsi);let T="";a.selectedDays.length>0&&a.scheduleStartTime&&a.scheduleEndTime&&(T=`${a.selectedDays.join(", ")}, ${a.scheduleStartTime}-${a.scheduleEndTime}`),o.append("jadwal",T),o.append("pembina",a.pembina),o.append("lokasi",a.lokasi),o.append("is_active",a.is_active?"1":"0"),a.maxParticipants&&o.append("max_participants",a.maxParticipants),o.append("enable_registration",a.enableRegistration?"1":"0"),a.deadlineDate&&a.deadlineTime&&o.append("registration_deadline",`${a.deadlineDate}T${a.deadlineTime}`),a.benefits.forEach((x,V)=>{x.trim()&&o.append(`benefits[${V}]`,x.trim())}),a.whatsappAdmin&&o.append("whatsapp_admin",a.whatsappAdmin),K.value?o.append("gambar",K.value,"cropped-image.webp"):F.value&&o.append("gambar",F.value);const P=L.value?`/api/yasmin-panel/ekstrakurikuler/${n.value.id}`:"/api/yasmin-panel/ekstrakurikuler",f=await fetch(P,{method:"POST",headers:{Authorization:`Bearer ${p}`,Accept:"application/json"},body:o});if(!f.ok){const x=await f.json();throw new Error(x.message||"Gagal menyimpan")}re(),await c("Berhasil!",L.value?"Data diupdate!":"Data ditambahkan!"),de(),await t()}catch(p){re(),await k("Gagal!",p.message||"Gagal menyimpan")}finally{R.value=!1}},$e=()=>{r.value=!1,de(),document.body.style.overflow=""},de=()=>{L.value=!1,E.value=null,F.value=null,K.value=null,j.value=!0,G.value=!1,n.value={nama:"",tagline:"",badge:"",deskripsi:"",benefits:[""],jadwal:"",pembina:"",lokasi:"",is_active:!0,gambar:null,selectedDays:[],scheduleStartTime:"",scheduleEndTime:"",enableRegistration:!1,registrationToken:"",maxParticipants:null,registrationDeadline:"",deadlineDate:"",deadlineTime:"",whatsappAdmin:""}};return Oe(()=>{t()}),(a,p)=>(l(),i("div",Ea,[m(He,{onAdd:p[0]||(p[0]=o=>r.value=!0)}),m(et,{searchQuery:S.value,"onUpdate:searchQuery":p[1]||(p[1]=o=>S.value=o),badgeFilter:g.value,"onUpdate:badgeFilter":p[2]||(p[2]=o=>g.value=o),statusFilter:y.value,"onUpdate:statusFilter":p[3]||(p[3]=o=>y.value=o)},null,8,["searchQuery","badgeFilter","statusFilter"]),X.value?(l(),i("div",Aa,[m(Ce,{size:"lg",color:"blue"})])):U.value?(l(),i("div",Pa,[e("p",Ia,w(U.value),1)])):(l(),se(Bt,{key:2,items:s.value,onEdit:ke,onDelete:we,onToggleStatus:he},null,8,["items"])),m(Sa,{show:r.value,"edit-mode":L.value,form:n.value,submitting:R.value,"can-generate-token":j.value,"generating-token":G.value,"token-copied":q.value,"image-preview":E.value,onClose:$e,onSubmit:Te,onGenerateToken:A,onCopyToken:Q,onImageCrop:fe,onRemoveImage:ve},null,8,["show","edit-mode","form","submitting","can-generate-token","generating-token","token-copied","image-preview"])]))}},La=ae(Ba,[["__scopeId","data-v-e9585842"]]);export{La as default};
