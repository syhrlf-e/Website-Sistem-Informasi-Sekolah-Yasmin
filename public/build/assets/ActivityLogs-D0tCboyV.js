import{r as d,w as B,o as K,i,k as n,e as k,F as v,l as e,f as M,B as S,u as D,O as Y,W as N,C as h,t as r,j as m,A as F,m as G,Y as Q,g as X,U as q,T as Z,P as ee}from"./vendor-0BLfaBTW.js";import{a as te,L as ae}from"./app-F21Gw_vX.js";import{S as se,f as I,X as re,a0 as oe,H as ne,ac as ie,an as le,ab as de}from"./ui-BH4Jb6j-.js";const pe={class:"space-y-6"},ce={key:0,class:"flex flex-col items-center justify-center min-h-[400px]"},ue={class:"bg-white dark:bg-gray-800 rounded-2xl p-6 border border-gray-200 dark:border-gray-700"},ge={class:"flex flex-col md:flex-row gap-4"},xe={class:"flex-1 relative"},ye=["value"],be=["value"],fe={class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},ke={class:"overflow-x-auto"},ve={class:"w-full"},me={class:"divide-y divide-gray-200 dark:divide-gray-700"},_e=["onClick"],he={class:"px-6 py-4"},we={class:"flex items-center gap-3"},Se={class:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold text-xs"},De={class:"font-medium text-gray-900 dark:text-white font-poppins"},Ae={class:"px-6 py-4"},Le={class:"px-6 py-4 max-w-xs"},je={class:"text-sm text-gray-900 dark:text-white font-poppins truncate"},Pe={key:0,class:"text-xs text-gray-500 dark:text-gray-400"},Ce={class:"px-6 py-4"},Ue={class:"text-sm text-gray-900 dark:text-white font-poppins"},Te={class:"text-xs text-gray-500 dark:text-gray-400"},Ve={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 font-mono"},Be={key:0},Me={colspan:"5",class:"px-6 py-12 text-center"},Ne={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between"},Fe={class:"text-sm text-gray-600 dark:text-gray-400 font-poppins"},Ie={class:"flex gap-2"},Oe=["disabled"],$e={class:"px-3 py-1 text-sm text-gray-600 dark:text-gray-400 font-poppins"},ze=["disabled"],Je={class:"bg-white dark:bg-gray-800 rounded-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden border border-gray-200 dark:border-gray-700"},Ee={class:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700"},Re={class:"p-6 space-y-4 overflow-y-auto max-h-[60vh]"},We={class:"grid grid-cols-2 gap-4"},He={class:"font-semibold text-gray-900 dark:text-white font-poppins"},Ke={class:"font-semibold text-gray-900 dark:text-white font-poppins"},Ye={class:"font-mono text-gray-900 dark:text-white"},Ge={class:"text-gray-900 dark:text-white font-poppins"},Qe={key:0,class:"space-y-3"},Xe={class:"space-y-3"},qe={class:"text-[10px] font-semibold text-gray-600 dark:text-gray-400 uppercase mb-2"},Ze={class:"space-y-2"},et={class:"bg-red-50 dark:bg-red-900/20 rounded-lg p-2"},tt={class:"text-[11px] text-red-800 dark:text-red-300 break-words whitespace-pre-wrap"},at={class:"bg-green-50 dark:bg-green-900/20 rounded-lg p-2"},st={class:"text-[11px] text-green-800 dark:text-green-300 break-words whitespace-pre-wrap"},rt={key:1,class:"space-y-3"},ot={class:"bg-green-50 dark:bg-green-900/20 rounded-xl p-4"},nt={class:"text-sm text-green-700 dark:text-green-400"},it={key:2,class:"space-y-3"},lt={class:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4"},dt={class:"text-sm text-red-700 dark:text-red-400"},pt={__name:"ActivityLogs",setup(ct){const _=d([]),A=d([]),L=d([]),c=d({current_page:1,last_page:1,total:0}),j=d(!0),P=d(!1),x=d(""),y=d("all"),b=d("all"),g=d(1),o=d(null),f=async()=>{try{P.value=!0;const s=sessionStorage.getItem("admin_token"),t=new URLSearchParams({page:g.value,per_page:15,...y.value!=="all"&&{action:y.value},...b.value!=="all"&&{user_id:b.value},...x.value&&{search:x.value}}),l=await(await fetch(`/api/yasmin-panel/activity-logs?${t}`,{headers:{Authorization:`Bearer ${s}`,Accept:"application/json"}})).json();l.success&&(_.value=l.data,c.value=l.meta)}catch(s){console.error("Error fetching logs:",s)}finally{P.value=!1,j.value=!1}},O=async()=>{try{const t={Authorization:`Bearer ${sessionStorage.getItem("admin_token")}`,Accept:"application/json"},[a,l]=await Promise.all([fetch("/api/yasmin-panel/activity-logs/actions",{headers:t}),fetch("/api/yasmin-panel/activity-logs/users",{headers:t})]),p=await a.json(),u=await l.json();p.success&&(A.value=p.data),u.success&&(L.value=u.data)}catch(s){console.error("Error fetching filters:",s)}},w=s=>({create:"Buat",update:"Update",delete:"Hapus",login:"Login",logout:"Logout"})[s]||s,C=s=>({create:"bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-400",update:"bg-yellow-50 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400",delete:"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400",login:"bg-blue-50 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400",logout:"bg-gray-50 dark:bg-gray-900/20 text-gray-700 dark:text-gray-400"})[s]||"bg-gray-50 dark:bg-gray-900/20 text-gray-700 dark:text-gray-400",$=s=>({create:de,update:le,delete:ie,login:ne,logout:oe})[s]||I,U=s=>{if(!s.old_values||!s.new_values)return[];const t=[],a=["updated_at","created_at","deleted_at","remember_token","email_verified_at"];for(const l of Object.keys(s.new_values)){if(a.includes(l))continue;const p=s.old_values[l],u=s.new_values[l],W=typeof p=="object"?JSON.stringify(p):String(p??""),H=typeof u=="object"?JSON.stringify(u):String(u??"");W!==H&&t.push({field:l,old:p,new:u})}return t},z=s=>({nama:"Nama",title:"Judul",content:"Konten",excerpt:"Ringkasan",image:"Gambar",is_active:"Status Aktif",is_featured:"Unggulan",published:"Dipublikasi",category:"Kategori",deskripsi:"Deskripsi",jadwal:"Jadwal",pembina:"Pembina",lokasi:"Lokasi",max_peserta:"Maks Peserta",role:"Peran",email:"Email",name:"Nama",author:"Penulis",location:"Lokasi",views:"Views",slug:"Slug",priority:"Prioritas",order:"Urutan"})[s]||s.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()),T=s=>s==null?"-":typeof s=="boolean"?s?"Ya":"Tidak":Array.isArray(s)?s.join(", "):typeof s=="object"?JSON.stringify(s,null,2):String(s),J=s=>{o.value=s},E=()=>{g.value>1&&(g.value--,f())},R=()=>{g.value<c.value.last_page&&(g.value++,f())};B([y,b],()=>{g.value=1,f()});let V;return B(x,()=>{clearTimeout(V),V=setTimeout(()=>{g.value=1,f()},500)}),K(()=>{O(),f()}),(s,t)=>(n(),i("div",pe,[j.value?(n(),i("div",ce,[k(ae,{size:"lg",color:"blue"})])):(n(),i(v,{key:1},[t[20]||(t[20]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"}," Activity Logs "),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"}," Pantau aktivitas admin di sistem ")],-1)),e("div",ue,[e("div",ge,[e("div",xe,[k(D(se),{class:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),S(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>x.value=a),type:"text",placeholder:"Cari aktivitas...",class:"w-full pl-10 pr-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[Y,x.value]])]),S(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>y.value=a),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[t[5]||(t[5]=e("option",{value:"all"},"Semua Aksi",-1)),(n(!0),i(v,null,h(A.value,a=>(n(),i("option",{key:a,value:a},r(w(a)),9,ye))),128))],512),[[N,y.value]]),S(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>b.value=a),class:"px-4 py-2.5 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},[t[6]||(t[6]=e("option",{value:"all"},"Semua User",-1)),(n(!0),i(v,null,h(L.value,a=>(n(),i("option",{key:a.user_id,value:a.user_id},r(a.user_name),9,be))),128))],512),[[N,b.value]])])]),e("div",fe,[e("div",ke,[e("table",ve,[t[8]||(t[8]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"}," User "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"}," Aksi "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"}," Deskripsi "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"}," Waktu "),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider font-poppins"}," IP ")])],-1)),e("tbody",me,[(n(!0),i(v,null,h(_.value,a=>{var l,p;return n(),i("tr",{key:a.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors duration-150 cursor-pointer",onClick:u=>J(a)},[e("td",he,[e("div",we,[e("div",Se,r(((p=(l=a.user_name)==null?void 0:l[0])==null?void 0:p.toUpperCase())||"S"),1),e("span",De,r(a.user_name),1)])]),e("td",Ae,[e("span",{class:F([C(a.action),"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium font-poppins"])},[(n(),M(Q($(a.action)),{class:"w-3 h-3"})),G(" "+r(w(a.action)),1)],2)]),e("td",Le,[e("p",je,r(a.description),1),a.model_type?(n(),i("p",Pe,r(a.model_type)+" #"+r(a.model_id),1)):m("",!0)]),e("td",Ce,[e("p",Ue,r(a.time_ago),1),e("p",Te,r(a.created_at),1)]),e("td",Ve,r(a.ip_address||"-"),1)],8,_e)}),128)),_.value.length===0?(n(),i("tr",Be,[e("td",Me,[k(D(I),{class:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),t[7]||(t[7]=e("p",{class:"text-gray-500 dark:text-gray-400 font-poppins"},"Belum ada aktivitas tercatat",-1))])])):m("",!0)])])]),c.value.total>0?(n(),i("div",Ne,[e("p",Fe," Menampilkan "+r(_.value.length)+" dari "+r(c.value.total)+" aktivitas ",1),e("div",Ie,[e("button",{onClick:E,disabled:c.value.current_page===1,class:"px-3 py-1 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed font-poppins text-sm"}," Sebelumnya ",8,Oe),e("span",$e,r(c.value.current_page)+" / "+r(c.value.last_page),1),e("button",{onClick:R,disabled:c.value.current_page===c.value.last_page,class:"px-3 py-1 rounded-lg border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed font-poppins text-sm"}," Selanjutnya ",8,ze)])])):m("",!0)]),(n(),M(ee,{to:"body"},[k(Z,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-200","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:X(()=>[o.value?(n(),i("div",{key:0,class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4",onClick:t[4]||(t[4]=q(a=>o.value=null,["self"]))},[e("div",Je,[e("div",Ee,[t[9]||(t[9]=e("h2",{class:"text-xl font-bold text-gray-900 dark:text-white font-poppins"}," Detail Aktivitas ",-1)),e("button",{onClick:t[3]||(t[3]=a=>o.value=null),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[k(D(re),{class:"w-5 h-5 text-gray-500"})])]),e("div",Re,[e("div",We,[e("div",null,[t[10]||(t[10]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"User",-1)),e("p",He,r(o.value.user_name),1)]),e("div",null,[t[11]||(t[11]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"Aksi",-1)),e("span",{class:F([C(o.value.action),"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium font-poppins"])},r(w(o.value.action)),3)]),e("div",null,[t[12]||(t[12]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"Waktu",-1)),e("p",Ke,r(o.value.created_at),1)]),e("div",null,[t[13]||(t[13]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"IP Address",-1)),e("p",Ye,r(o.value.ip_address||"-"),1)])]),e("div",null,[t[14]||(t[14]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mb-1"},"Deskripsi",-1)),e("p",Ge,r(o.value.description),1)]),o.value.has_changes&&U(o.value).length>0?(n(),i("div",Qe,[t[17]||(t[17]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase"},"Perubahan Data",-1)),e("div",Xe,[(n(!0),i(v,null,h(U(o.value),a=>(n(),i("div",{key:a.field,class:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-3"},[e("p",qe,r(z(a.field)),1),e("div",Ze,[e("div",et,[t[15]||(t[15]=e("p",{class:"text-[9px] font-semibold text-red-600 dark:text-red-400 mb-1"},"Sebelum",-1)),e("p",tt,r(T(a.old)),1)]),e("div",at,[t[16]||(t[16]=e("p",{class:"text-[9px] font-semibold text-green-600 dark:text-green-400 mb-1"},"Sesudah",-1)),e("p",st,r(T(a.new)),1)])])]))),128))])])):o.value.action==="create"&&o.value.new_values?(n(),i("div",rt,[t[18]||(t[18]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase"},"Data Dibuat",-1)),e("div",ot,[e("p",nt," Data baru berhasil dibuat dengan ID #"+r(o.value.new_values.id||o.value.model_id),1)])])):o.value.action==="delete"&&o.value.old_values?(n(),i("div",it,[t[19]||(t[19]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 font-semibold uppercase"},"Data Dihapus",-1)),e("div",lt,[e("p",dt," Data dengan ID #"+r(o.value.old_values.id||o.value.model_id)+" telah dihapus ",1)])])):m("",!0)])])])):m("",!0)]),_:1})]))],64))]))}},yt=te(pt,[["__scopeId","data-v-18e1c893"]]);export{yt as default};
