import{i,k as l,l as e,e as m,m as w,u as f,c as L,f as O,g as N,j as y,t as d,B as _,O as S,W as R,T as D,F as Y,C as K,A as V,r as p,o as W}from"./vendor-0BLfaBTW.js";import{a as A,L as X,u as J,c as h,d as Q}from"./app-F21Gw_vX.js";import{a7 as Z,X as ee,ad as te,ac as ae,l as se}from"./ui-BH4Jb6j-.js";const re={class:"flex items-center justify-between"},oe={__name:"UsersPageHeader",emits:["add"],setup(a){return(c,r)=>(l(),i("div",re,[r[2]||(r[2]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},"Manajemen Pengguna"),e("p",{class:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Kelola admin dan editor")],-1)),e("button",{onClick:r[0]||(r[0]=n=>c.$emit("add")),class:"flex items-center gap-2 px-5 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-medium shadow-lg font-poppins"},[m(f(Z),{class:"w-5 h-5"}),r[1]||(r[1]=w(" Tambah Admin ",-1))])]))}},ne=A(oe,[["__scopeId","data-v-89924d84"]]),de={key:0,class:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-sm flex items-center justify-center overflow-y-auto"},le={class:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full p-6 m-4 border border-gray-200 dark:border-gray-700"},ie={class:"flex items-center justify-between mb-6"},ue={class:"text-2xl font-bold text-gray-900 dark:text-white font-poppins"},pe={key:0,class:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg"},ce={class:"text-sm text-red-600 dark:text-red-400 font-poppins"},ge={class:"space-y-4"},me={key:0},be=["required"],xe=["disabled"],ye={key:0,class:"mt-2 text-xs text-gray-500 font-poppins"},fe={class:"flex items-center gap-3 pt-4"},ve=["disabled"],ke={__name:"UsersPageModal",props:{show:Boolean,editMode:Boolean,form:Object,formError:String,submitting:Boolean,superAdminExists:Boolean},emits:["close","submit"],setup(a){const c=a,r=L(()=>c.editMode&&c.form.role==="super_admin");return(n,t)=>(l(),O(D,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","leave-active-class":"transition-opacity duration-200","leave-to-class":"opacity-0"},{default:N(()=>[a.show?(l(),i("div",de,[e("div",le,[e("div",ie,[e("h2",ue,d(a.editMode?"Edit User":"Tambah Admin Baru"),1),e("button",{onClick:t[0]||(t[0]=o=>n.$emit("close")),class:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors"},[m(f(ee),{class:"w-5 h-5 text-gray-500"})])]),a.formError?(l(),i("div",pe,[e("p",ce,d(a.formError),1)])):y("",!0),e("div",ge,[e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Nama Lengkap "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.form.name=o),type:"text",required:"",placeholder:"Masukkan nama lengkap",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[S,a.form.name]])]),e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Email "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.form.email=o),type:"email",required:"",autocomplete:"off",placeholder:"admin@smk.com",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,512),[[S,a.form.email]])]),a.editMode?y("",!0):(l(),i("div",me,[t[8]||(t[8]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Password "),e("span",{class:"text-red-500"},"*")],-1)),_(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>a.form.password=o),type:"password",required:!a.editMode,autocomplete:"new-password",placeholder:"Min. 6 karakter",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-white font-poppins"},null,8,be),[[S,a.form.password]])])),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-semibold text-gray-900 dark:text-white mb-2 font-poppins"},[w("Role "),e("span",{class:"text-red-500"},"*")],-1)),_(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>a.form.role=o),required:"",class:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-xl text-gray-900 dark:text-white font-poppins"},[t[9]||(t[9]=e("option",{value:""},"Pilih Role",-1)),t[10]||(t[10]=e("option",{value:"admin"},"Admin",-1)),t[11]||(t[11]=e("option",{value:"admin_ppdb"},"Admin PPDB",-1)),e("option",{value:"super_admin",disabled:a.superAdminExists&&!r.value}," Super Admin "+d(a.superAdminExists&&!r.value?"(Sudah ada)":""),9,xe)],512),[[R,a.form.role]]),a.superAdminExists&&!r.value?(l(),i("p",ye,"⚠️ Super Admin hanya boleh 1 orang")):y("",!0)]),e("div",fe,[e("button",{onClick:t[5]||(t[5]=o=>n.$emit("submit")),disabled:a.submitting,class:"flex-1 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-semibold font-poppins disabled:opacity-50"},d(a.submitting?"Menyimpan...":a.editMode?"Update":"Simpan"),9,ve)])])])])):y("",!0)]),_:1}))}},he=A(ke,[["__scopeId","data-v-efb00568"]]),we={key:0,class:"py-12"},$e={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4"},Ue={class:"text-red-600 dark:text-red-400 font-poppins"},_e={key:2,class:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 overflow-hidden"},Ae={class:"overflow-x-auto"},Me={class:"w-full"},Ce={class:"divide-y divide-gray-200 dark:divide-gray-700"},Pe={class:"px-6 py-4 text-sm text-gray-900 dark:text-white font-poppins"},Ee={class:"px-6 py-4"},Se={class:"flex items-center gap-3"},Be={class:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold"},Te={class:"font-semibold text-gray-900 dark:text-white font-poppins"},je={class:"px-6 py-4 text-sm text-gray-600 dark:text-gray-400 font-poppins"},Ie={class:"px-6 py-4"},Ve={class:"px-6 py-4"},Ne={class:"flex items-center justify-center gap-2"},De=["onClick"],qe=["onClick","disabled","title"],ze={key:0,class:"px-6 py-4 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between"},Fe={class:"text-sm text-gray-600 dark:text-gray-400 font-poppins"},Ge={class:"flex gap-2"},He=["disabled"],Le=["disabled"],Oe={__name:"UsersPageTable",props:{users:Object,loading:Boolean,error:String,currentUserId:Number},emits:["edit","delete","page-change"],setup(a){const c=(r,n)=>!(r.role==="super_admin"||r.id===n);return(r,n)=>a.loading?(l(),i("div",we,[m(X,{size:"lg",color:"blue"})])):a.error?(l(),i("div",$e,[e("p",Ue,d(a.error),1)])):(l(),i("div",_e,[e("div",Ae,[e("table",Me,[n[2]||(n[2]=e("thead",{class:"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"#"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"User"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Email"),e("th",{class:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Role"),e("th",{class:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase font-poppins"},"Action")])],-1)),e("tbody",Ce,[(l(!0),i(Y,null,K(a.users.data,(t,o)=>(l(),i("tr",{key:t.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},[e("td",Pe,d((a.users.current_page-1)*a.users.per_page+o+1),1),e("td",Ee,[e("div",Se,[e("div",Be,d(t.name[0].toUpperCase()),1),e("p",Te,d(t.name),1)])]),e("td",je,d(t.email),1),e("td",Ie,[e("span",{class:V(["inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold font-poppins",t.role==="super_admin"?"bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-400":"bg-purple-50 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400"])},d(t.role==="super_admin"?"Super Admin":"Admin"),3)]),e("td",Ve,[e("div",Ne,[e("button",{onClick:v=>r.$emit("edit",t),class:"p-2 rounded-lg bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 hover:bg-blue-100",title:"Edit"},[m(f(te),{class:"w-4 h-4"})],8,De),e("button",{onClick:v=>r.$emit("delete",t),disabled:!c(t,a.currentUserId),class:V(["p-2 rounded-lg",c(t,a.currentUserId)?"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 hover:bg-red-100":"bg-gray-100 dark:bg-gray-700 text-gray-400 cursor-not-allowed opacity-50"]),title:c(t,a.currentUserId)?"Hapus":t.role==="super_admin"?"Super Admin tidak bisa dihapus":"Tidak bisa menghapus diri sendiri"},[m(f(ae),{class:"w-4 h-4"})],10,qe)])])]))),128))])])]),a.users.last_page>1?(l(),i("div",ze,[e("p",Fe," Menampilkan "+d(a.users.from)+" - "+d(a.users.to)+" dari "+d(a.users.total)+" users ",1),e("div",Ge,[e("button",{onClick:n[0]||(n[0]=t=>r.$emit("page-change",a.users.current_page-1)),disabled:a.users.current_page===1,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 font-poppins"},"Previous",8,He),e("button",{onClick:n[1]||(n[1]=t=>r.$emit("page-change",a.users.current_page+1)),disabled:a.users.current_page===a.users.last_page,class:"px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 disabled:opacity-50 font-poppins"},"Next",8,Le)])])):y("",!0)]))}},Re=A(Oe,[["__scopeId","data-v-072d8fde"]]),Ye={class:"space-y-6"},Ke={key:0,class:"fixed top-6 left-1/2 -translate-x-1/2 z-[10001] bg-green-500 text-white px-6 py-4 rounded-xl shadow-2xl flex items-center gap-3 font-poppins"},We={class:"font-semibold"},Xe={__name:"UsersPage",setup(a){const{user:c}=J(),{showError:r,confirm:n}=Q(),t=p(!1),o=p(!1),v=p(!1),M=p(!1),C=p(null),$=p(null),B=p(!1),P=p(!1),T=p(""),u=p({id:null,name:"",email:"",password:"",role:""}),k=p({data:[],current_page:1,last_page:1,per_page:10,total:0,from:0,to:0}),U=async(s=1)=>{var b,g;v.value=!0,C.value=null;try{const x=await h.get(`/yasmin-panel/users?page=${s}`);k.value=x.data}catch(x){C.value=((g=(b=x.response)==null?void 0:b.data)==null?void 0:g.message)||"Gagal memuat data users"}finally{v.value=!1}},j=async()=>{try{const s=await h.get("/yasmin-panel/users/check-super-admin");B.value=s.data.super_admin_exists}catch{}},q=s=>{o.value=!0,u.value={id:s.id,name:s.name,email:s.email,password:"",role:s.role},t.value=!0},z=async s=>{var g,x;if((await n(`Yakin ingin menghapus user "${s.name}"?`,"Tindakan ini tidak dapat dibatalkan","Ya, Hapus")).isConfirmed)try{await h.delete(`/yasmin-panel/users/${s.id}`),await U(k.value.current_page),E("User berhasil dihapus!")}catch(H){await r("Gagal Menghapus User",((x=(g=H.response)==null?void 0:g.data)==null?void 0:x.message)||"Gagal menghapus user")}},F=async()=>{var s,b;M.value=!0,$.value=null;try{o.value?(await h.put(`/yasmin-panel/users/${u.value.id}`,{name:u.value.name,email:u.value.email,role:u.value.role}),E("User berhasil diupdate!")):(await h.post("/yasmin-panel/users",{name:u.value.name,email:u.value.email,password:u.value.password,role:u.value.role}),E("Admin berhasil ditambahkan!")),await U(k.value.current_page),await j(),I()}catch(g){$.value=((b=(s=g.response)==null?void 0:s.data)==null?void 0:b.message)||"Gagal menyimpan user"}finally{M.value=!1}},E=s=>{T.value=s,P.value=!0,setTimeout(()=>{P.value=!1},3e3)},I=()=>{t.value=!1,o.value=!1,$.value=null,u.value={id:null,name:"",email:"",password:"",role:""}},G=s=>{s>=1&&s<=k.value.last_page&&U(s)};return W(()=>{U(),j()}),(s,b)=>{var g;return l(),i("div",Ye,[m(ne,{onAdd:b[0]||(b[0]=x=>t.value=!0)}),m(Re,{users:k.value,loading:v.value,error:C.value,"current-user-id":(g=f(c))==null?void 0:g.id,onEdit:q,onDelete:z,onPageChange:G},null,8,["users","loading","error","current-user-id"]),m(he,{show:t.value,"edit-mode":o.value,form:u.value,"form-error":$.value,submitting:M.value,"super-admin-exists":B.value,onClose:I,onSubmit:F},null,8,["show","edit-mode","form","form-error","submitting","super-admin-exists"]),m(D,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 -translate-y-4","leave-active-class":"transition-all duration-200 ease-in","leave-to-class":"opacity-0 -translate-y-4"},{default:N(()=>[P.value?(l(),i("div",Ke,[m(f(se),{class:"w-6 h-6"}),e("span",We,d(T.value),1)])):y("",!0)]),_:1})])}}},et=A(Xe,[["__scopeId","data-v-c52e211c"]]);export{et as default};
