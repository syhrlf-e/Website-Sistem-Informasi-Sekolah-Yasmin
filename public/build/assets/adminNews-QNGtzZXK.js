import{c as r}from"./app-F21Gw_vX.js";import{z as n}from"./vendor-0BLfaBTW.js";const l=n("adminNews",{state:()=>({items:[],currentNews:null,currentPage:1,perPage:10,total:0,lastPage:1,from:0,to:0,searchQuery:"",filterCategory:"",filterStatus:"",loading:!1,error:null}),getters:{hasNextPage:t=>t.currentPage<t.lastPage,hasPrevPage:t=>t.currentPage>1},actions:{async fetchNews(t=1){var s,a;this.loading=!0,this.error=null,this.currentPage=t;try{const e=await r.get("/yasmin-panel/news",{params:{page:t,per_page:this.perPage,search:this.searchQuery||void 0,category:this.filterCategory||void 0,status:this.filterStatus||void 0}});e.data.success&&(this.items=e.data.data||[],e.data.meta&&(this.currentPage=e.data.meta.current_page,this.lastPage=e.data.meta.last_page,this.total=e.data.meta.total,this.perPage=e.data.meta.per_page,this.from=e.data.meta.from,this.to=e.data.meta.to))}catch(e){this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal memuat data berita"}finally{this.loading=!1}},async fetchNewsById(t){var s,a;this.loading=!0,this.error=null;try{const e=await r.get(`/yasmin-panel/news/${t}`);if(e.data.success)return this.currentNews=e.data.data,e.data.data}catch(e){throw this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal memuat detail berita",e}finally{this.loading=!1}},async createNews(t){var s,a;this.loading=!0,this.error=null;try{const e=await r.post("/yasmin-panel/news",t,{headers:{"Content-Type":"multipart/form-data"}});if(e.data.success)return e.data.data}catch(e){throw this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal membuat berita",e}finally{this.loading=!1}},async updateNews(t,s){var a,e;this.loading=!0,this.error=null;try{const i=await r.post(`/yasmin-panel/news/${t}`,s,{headers:{"Content-Type":"multipart/form-data"}});if(i.data.success)return i.data.data}catch(i){throw this.error=((e=(a=i.response)==null?void 0:a.data)==null?void 0:e.message)||"Gagal mengupdate berita",i}finally{this.loading=!1}},async deleteNews(t){var s,a;this.loading=!0,this.error=null;try{if((await r.delete(`/yasmin-panel/news/${t}`)).data.success)return await this.fetchNews(),this.items.length===0&&this.currentPage>1&&await this.goToPage(this.currentPage-1),!0}catch(e){throw this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal menghapus berita",e}finally{this.loading=!1}},async fetchTrashedNews(){var t,s;this.loading=!0,this.error=null;try{const a={page:this.currentPage,per_page:this.perPage},e=await r.get("/yasmin-panel/news/trash",{params:a});e.data.success&&(this.items=e.data.data,this.currentPage=e.data.meta.current_page,this.lastPage=e.data.meta.last_page,this.total=e.data.meta.total,this.from=e.data.meta.from,this.to=e.data.meta.to)}catch(a){this.error=((s=(t=a.response)==null?void 0:t.data)==null?void 0:s.message)||"Gagal memuat data trash"}finally{this.loading=!1}},async restoreNews(t){var s,a;this.loading=!0,this.error=null;try{if((await r.post(`/yasmin-panel/news/${t}/restore`)).data.success)return await this.fetchTrashedNews(),this.items.length===0&&this.currentPage>1&&await this.goToPage(this.currentPage-1),!0}catch(e){throw this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal memulihkan berita",e}finally{this.loading=!1}},async forceDeleteNews(t){var s,a;this.loading=!0,this.error=null;try{if((await r.delete(`/yasmin-panel/news/${t}/force`)).data.success)return await this.fetchTrashedNews(),this.items.length===0&&this.currentPage>1&&await this.goToPage(this.currentPage-1),!0}catch(e){throw this.error=((a=(s=e.response)==null?void 0:s.data)==null?void 0:a.message)||"Gagal menghapus berita permanen",e}finally{this.loading=!1}},setSearch(t){this.searchQuery=t,this.fetchNews(1)},setCategory(t){this.filterCategory=t,this.fetchNews(1)},setStatus(t){this.filterStatus=t,this.fetchNews(1)},goToPage(t){t>=1&&t<=this.lastPage&&this.fetchNews(t)},clearCurrentNews(){this.currentNews=null},resetFilters(){this.searchQuery="",this.filterCategory="",this.filterStatus="",this.fetchNews(1)}}});export{l as u};
